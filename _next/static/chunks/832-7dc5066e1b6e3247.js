"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[832],{8031:function(t,e,r){r.r(e),r.d(e,{isAnyArray:function(){return isAnyArray}});let n=Object.prototype.toString;function isAnyArray(t){let e=n.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},1837:function(t,e,r){r.r(e),r.d(e,{default:function(){return rescale}});var n=r(8031);function max(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,n.isAnyArray)(t))throw TypeError("input must be an array");if(0===t.length)throw TypeError("input must not be empty");var r=e.fromIndex,i=void 0===r?0:r,o=e.toIndex,s=void 0===o?t.length:o;if(i<0||i>=t.length||!Number.isInteger(i))throw Error("fromIndex must be a positive integer smaller than length");if(s<=i||s>t.length||!Number.isInteger(s))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[i],u=i+1;u<s;u++)t[u]>a&&(a=t[u]);return a}function min(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,n.isAnyArray)(t))throw TypeError("input must be an array");if(0===t.length)throw TypeError("input must not be empty");var r=e.fromIndex,i=void 0===r?0:r,o=e.toIndex,s=void 0===o?t.length:o;if(i<0||i>=t.length||!Number.isInteger(i))throw Error("fromIndex must be a positive integer smaller than length");if(s<=i||s>t.length||!Number.isInteger(s))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[i],u=i+1;u<s;u++)t[u]<a&&(a=t[u]);return a}function rescale(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,n.isAnyArray)(t)){if(0===t.length)throw TypeError("input must not be empty")}else throw TypeError("input must be an array");if(void 0!==r.output){if(!(0,n.isAnyArray)(r.output))throw TypeError("output option must be an array if specified");e=r.output}else e=Array(t.length);var i=min(t),o=max(t);if(i===o)throw RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var s=r.min,a=void 0===s?r.autoMinMax?i:0:s,u=r.max,l=void 0===u?r.autoMinMax?o:1:u;if(a>=l)throw RangeError("min option must be smaller than max option");for(var h=(l-a)/(o-i),c=0;c<t.length;c++)e[c]=(t[c]-i)*h+a;return e}},5024:function(t,e,r){r.r(e),r.d(e,{default:function(){return levenbergMarquardt}});let n=Object.prototype.toString;function isAnyArray(t){return n.call(t).endsWith("Array]")}function errorCalculation(t,e,r){let n=0,i=r(e);for(let e=0;e<t.x.length;e++)n+=Math.abs(t.y[e]-i(t.x[e]));return n}var i=r(5633);i.XA,i.a_,i.yQ,i.Hs,i.Ec,i.dx,i.LU,i.Rm;let o=i.y3;i.qK,i.pb,i.j,i.sO,i.BZ,i.EK,i.Db,i.Fx,i.tU,i.Ym,i.rs,i.QR,i.TB,i.oH,i.Sc,i.BN,i.it,i.$r,i.QM,i.AV,i.y3,i.y3,i.GH;let s=i.SO;function gradientFunction(t,e,r,n,i){let s=r.length,a=t.x.length,u=Array(s);for(let o=0;o<s;o++){u[o]=Array(a);let s=r.slice();s[o]+=n;let l=i(s);for(let r=0;r<a;r++)u[o][r]=e[r]-l(t.x[r])}return new o(u)}function matrixFunction(t,e){let r=t.x.length,n=Array(r);for(let i=0;i<r;i++)n[i]=[t.y[i]-e[i]];return new o(n)}function step(t,e,r,n,i){let a=r*n*n,u=o.eye(e.length,e.length,a),l=i(e),h=new Float64Array(t.x.length);for(let e=0;e<t.x.length;e++)h[e]=l(t.x[e]);let c=gradientFunction(t,h,e,n,i),f=matrixFunction(t,h),m=s(u.add(c.mmul(c.transpose())));return(e=(e=new o([e])).sub(m.mmul(c).mmul(f).mul(n).transpose())).to1DArray()}function levenbergMarquardt(t,e,r={}){let n,{maxIterations:i=100,gradientDifference:o=.1,damping:s=0,errorTolerance:a=.01,minValues:u,maxValues:l,initialValues:h}=r;if(s<=0)throw Error("The damping option must be a positive number");if(t.x&&t.y){if(!isAnyArray(t.x)||t.x.length<2||!isAnyArray(t.y)||t.y.length<2)throw Error("The data parameter elements must be an array with more than 2 points");if(t.x.length!==t.y.length)throw Error("The data parameter elements must have the same size")}else throw Error("The data parameter must have x and y elements");let c=h||Array(e.length).fill(1),f=c.length;if(l=l||Array(f).fill(Number.MAX_SAFE_INTEGER),u=u||Array(f).fill(Number.MIN_SAFE_INTEGER),l.length!==u.length)throw Error("minValues and maxValues must be the same size");if(!isAnyArray(c))throw Error("initialValues must be an array");let m=errorCalculation(t,c,e),p=m<=a;for(n=0;n<i&&!p;n++){c=step(t,c,s,o,e);for(let t=0;t<f;t++)c[t]=Math.min(Math.max(u[t],c[t]),l[t]);if(isNaN(m=errorCalculation(t,c,e)))break;p=m<=a}return{parameterValues:c,parameterError:m,iterations:n}}i.uZ,i.yU,i.F1,i.re},5633:function(t,e,r){var n=r(8031),i=r(1837);let o=" ".repeat(2),s=" ".repeat(4);function inspectMatrix(){return inspectMatrixWithOptions(this)}function inspectMatrixWithOptions(t,e={}){let{maxRows:r=15,maxColumns:n=10,maxNumSize:i=8,padMinus:a="auto"}=e;return`${t.constructor.name} {
${o}[
${s}${inspectData(t,r,n,i,a)}
${o}]
${o}rows: ${t.rows}
${o}columns: ${t.columns}
}`}function inspectData(t,e,r,n,i){let{rows:o,columns:a}=t,u=Math.min(o,e),l=Math.min(a,r),h=[];if("auto"===i){i=!1;t:for(let e=0;e<u;e++)for(let r=0;r<l;r++)if(0>t.get(e,r)){i=!0;break t}}for(let e=0;e<u;e++){let r=[];for(let o=0;o<l;o++)r.push(formatNumber(t.get(e,o),n,i));h.push(`${r.join(" ")}`)}return l!==a&&(h[h.length-1]+=` ... ${a-r} more columns`),u!==o&&h.push(`... ${o-e} more rows`),h.join(`
${s}`)}function formatNumber(t,e,r){return(t>=0&&r?` ${formatNumber2(t,e-1)}`:formatNumber2(t,e)).padEnd(e)}function formatNumber2(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function installMathOperations(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){let n=new e(t);return n.add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){let n=new e(t);return n.sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){let n=new e(t);return n.mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){let n=new e(t);return n.div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){let n=new e(t);return n.mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){let n=new e(t);return n.and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){let n=new e(t);return n.or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){let n=new e(t);return n.xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){let n=new e(t);return n.leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){let n=new e(t);return n.signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){let n=new e(t);return n.rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){let r=new e(t);return r.not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){let r=new e(t);return r.abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){let r=new e(t);return r.acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){let r=new e(t);return r.acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){let r=new e(t);return r.asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){let r=new e(t);return r.asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){let r=new e(t);return r.atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){let r=new e(t);return r.atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){let r=new e(t);return r.cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){let r=new e(t);return r.ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){let r=new e(t);return r.clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){let r=new e(t);return r.cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){let r=new e(t);return r.cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){let r=new e(t);return r.exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){let r=new e(t);return r.expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){let r=new e(t);return r.floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){let r=new e(t);return r.fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){let r=new e(t);return r.log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){let r=new e(t);return r.log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){let r=new e(t);return r.log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){let r=new e(t);return r.log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){let r=new e(t);return r.round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){let r=new e(t);return r.sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){let r=new e(t);return r.sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){let r=new e(t);return r.sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){let r=new e(t);return r.sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){let r=new e(t);return r.tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){let r=new e(t);return r.tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){let r=new e(t);return r.trunc()},t.pow=function(t,r){let n=new e(t);return n.pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t.get(e,r));return this}}function checkRowIndex(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw RangeError("Row index out of range")}function checkColumnIndex(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw RangeError("Column index out of range")}function checkRowVector(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw RangeError("vector size must be the same as the number of columns");return e}function checkColumnVector(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw RangeError("vector size must be the same as the number of rows");return e}function checkRowIndices(t,e){if(!n.isAnyArray(e))throw TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw RangeError("row indices are out of range")}function checkColumnIndices(t,e){if(!n.isAnyArray(e))throw TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw RangeError("column indices are out of range")}function checkRange(t,e,r,n,i){if(5!=arguments.length)throw RangeError("expected 4 arguments");if(checkNumber("startRow",e),checkNumber("endRow",r),checkNumber("startColumn",n),checkNumber("endColumn",i),e>r||n>i||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw RangeError("Submatrix indices are out of range")}function newArray(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function checkNumber(t,e){if("number"!=typeof e)throw TypeError(`${t} must be a number`)}function checkNonEmpty(t){if(t.isEmpty())throw Error("Empty matrix has no elements to index")}function sumByRow(t){let e=newArray(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}function sumByColumn(t){let e=newArray(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}function sumAll(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}function productByRow(t){let e=newArray(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}function productByColumn(t){let e=newArray(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}function productAll(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}function varianceByRow(t,e,r){let n=t.rows,i=t.columns,o=[];for(let s=0;s<n;s++){let n=0,a=0,u=0;for(let e=0;e<i;e++)n+=u=t.get(s,e)-r[s],a+=u*u;e?o.push((a-n*n/i)/(i-1)):o.push((a-n*n/i)/i)}return o}function varianceByColumn(t,e,r){let n=t.rows,i=t.columns,o=[];for(let s=0;s<i;s++){let i=0,a=0,u=0;for(let e=0;e<n;e++)i+=u=t.get(e,s)-r[s],a+=u*u;e?o.push((a-i*i/n)/(n-1)):o.push((a-i*i/n)/n)}return o}function varianceAll(t,e,r){let n=t.rows,i=t.columns,o=n*i,s=0,a=0,u=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++)s+=u=t.get(e,n)-r,a+=u*u;return e?(a-s*s/o)/(o-1):(a-s*s/o)/o}function centerByRow(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}function centerByColumn(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}function centerAll(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}function getScaleByRow(t){let e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=t.get(r,e)**2/(t.columns-1);e.push(Math.sqrt(n))}return e}function scaleByRow(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}function getScaleByColumn(t){let e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=t.get(e,r)**2/(t.rows-1);e.push(Math.sqrt(n))}return e}function scaleByColumn(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}function getScaleAll(t){let e=t.size-1,r=0;for(let n=0;n<t.columns;n++)for(let i=0;i<t.rows;i++)r+=t.get(i,n)**2/e;return Math.sqrt(r)}function scaleAll(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}let AbstractMatrix=class AbstractMatrix{static from1DArray(t,e,r){if(t*e!==r.length)throw RangeError("data length does not match given dimensions");let n=new Matrix(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)n.set(i,t,r[i*e+t]);return n}static rowVector(t){let e=new Matrix(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new Matrix(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new Matrix(t,e)}static ones(t,e){return new Matrix(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw TypeError("options must be an object");let{random:n=Math.random}=r,i=new Matrix(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)i.set(r,t,n());return i}static randInt(t,e,r={}){if("object"!=typeof r)throw TypeError("options must be an object");let{min:n=0,max:i=1e3,random:o=Math.random}=r;if(!Number.isInteger(n))throw TypeError("min must be an integer");if(!Number.isInteger(i))throw TypeError("max must be an integer");if(n>=i)throw RangeError("min must be smaller than max");let s=i-n,a=new Matrix(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(o()*s);a.set(r,t,e)}return a}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<n;t++)i.set(t,t,r);return i}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let i=Math.min(n,e,r),o=this.zeros(e,r);for(let e=0;e<i;e++)o.set(e,e,t[e]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new Matrix(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)i.set(o,r,Math.min(t.get(o,r),e.get(o,r)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new this(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)i.set(o,r,Math.max(t.get(o,r),e.get(o,r)));return i}static checkMatrix(t){return AbstractMatrix.isMatrix(t)?t:new Matrix(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let i=e;i<t.rows;i++)t.get(i,r)>t.get(n,r)&&(n=i);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let i=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/i);for(let n=e+1;n<t.rows;n++){let i=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let o=r+1;o<t.columns;o++)t.set(n,o,t.get(n,o)-t.get(e,o)*i)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let i=0,o=!1;for(;i<r&&!1===o;)1===t.get(n,i)?o=!0:i++;for(let r=0;r<n;r++){let o=t.get(r,i);for(let s=i;s<e;s++){let e=t.get(r,s)-o*t.get(n,s);t.set(r,s,e)}}n--}return t}set(){throw Error("set method is unimplemented")}get(){throw Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw TypeError("columns must be a positive integer");let n=new Matrix(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){checkRowIndex(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return Matrix.rowVector(this.getRow(t))}setRow(t,e){checkRowIndex(this,t),e=checkRowVector(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){checkRowIndex(this,t),checkRowIndex(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){checkColumnIndex(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return Matrix.columnVector(this.getColumn(t))}setColumn(t,e){checkColumnIndex(this,t),e=checkColumnVector(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){checkColumnIndex(this,t),checkColumnIndex(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=checkRowVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=checkRowVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=checkRowVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=checkRowVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=checkColumnVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=checkColumnVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=checkColumnVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=checkColumnVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){checkRowIndex(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){checkColumnIndex(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{let t=Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{let t=Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw Error(`invalid option: ${t}`)}}maxIndex(){checkNonEmpty(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{let t=Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{let t=Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw Error(`invalid option: ${t}`)}}minIndex(){checkNonEmpty(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(checkRowIndex(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){checkRowIndex(this,t),checkNonEmpty(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(checkRowIndex(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){checkRowIndex(this,t),checkNonEmpty(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(checkColumnIndex(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){checkColumnIndex(this,t),checkNonEmpty(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(checkColumnIndex(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){checkColumnIndex(this,t),checkNonEmpty(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){AbstractMatrix.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=Matrix.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,i=new Matrix(e,n),o=new Float64Array(r);for(let s=0;s<n;s++){for(let e=0;e<r;e++)o[e]=t.get(e,s);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*o[n];i.set(t,s,e)}}return i}mpow(t){if(!this.isSquare())throw RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw RangeError("Exponent must be a non-negative integer");let e=Matrix.eye(this.rows),r=this;for(let n=t;n>=1;n/=2)(1&n)!=0&&(e=e.mmul(r)),r=r.mmul(r);return e}strassen2x2(t){t=Matrix.checkMatrix(t);let e=new Matrix(2,2),r=this.get(0,0),n=t.get(0,0),i=this.get(0,1),o=t.get(0,1),s=this.get(1,0),a=t.get(1,0),u=this.get(1,1),l=t.get(1,1),h=(r+u)*(n+l),c=(s+u)*n,f=r*(o-l),m=u*(a-n),p=(r+i)*l;return e.set(0,0,h+m-p+(i-u)*(a+l)),e.set(0,1,f+p),e.set(1,0,c+m),e.set(1,1,h-c+f+(s-r)*(n+o)),e}strassen3x3(t){t=Matrix.checkMatrix(t);let e=new Matrix(3,3),r=this.get(0,0),n=this.get(0,1),i=this.get(0,2),o=this.get(1,0),s=this.get(1,1),a=this.get(1,2),u=this.get(2,0),l=this.get(2,1),h=this.get(2,2),c=t.get(0,0),f=t.get(0,1),m=t.get(0,2),p=t.get(1,0),g=t.get(1,1),d=t.get(1,2),y=t.get(2,0),w=t.get(2,1),v=t.get(2,2),b=(r-o)*(-f+g),x=(-r+o+s)*(c-f+g),M=(o+s)*(-c+f),_=r*c,S=(-r+u+l)*(c-m+d),k=(-r+u)*(m-d),A=(u+l)*(-c+m),E=(-i+l+h)*(g+y-w),N=(i-h)*(g-w),R=i*y,z=(l+h)*(-y+w),C=(-i+s+a)*(d+y-v),T=(i-a)*(d-v),I=(s+a)*(-y+v);return e.set(0,0,_+R+n*p),e.set(0,1,(r+n+i-o-s-l-h)*g+x+M+_+E+R+z),e.set(0,2,_+S+A+(r+n+i-s-a-u-l)*d+R+C+I),e.set(1,0,b+s*(-c+f+p-g-d-y+v)+x+_+R+C+T),e.set(1,1,b+x+M+_+a*w),e.set(1,2,R+C+T+I+o*m),e.set(2,0,_+S+k+l*(-c+m+p-g-d-y+w)+E+N+R),e.set(2,1,E+N+R+z+u*f),e.set(2,2,_+S+k+A+h*v),e}mmulStrassen(t){t=Matrix.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,i=t.rows,o=t.columns;function embed(t,e,r){let n=t.rows,i=t.columns;return n===e&&i===r?t:AbstractMatrix.zeros(e,r).setSubMatrix(t,0,0)}n!==i&&console.warn(`Multiplying ${r} x ${n} and ${i} x ${o} matrix: dimensions do not match.`);let s=Math.max(r,i),a=Math.max(n,o);function blockMult(t,e,r,n){if(r<=512||n<=512)return t.mmul(e);r%2==1&&n%2==1?(t=embed(t,r+1,n+1),e=embed(e,r+1,n+1)):r%2==1?(t=embed(t,r+1,n),e=embed(e,r+1,n)):n%2==1&&(t=embed(t,r,n+1),e=embed(e,r,n+1));let i=parseInt(t.rows/2,10),o=parseInt(t.columns/2,10),s=t.subMatrix(0,i-1,0,o-1),a=e.subMatrix(0,i-1,0,o-1),u=t.subMatrix(0,i-1,o,t.columns-1),l=e.subMatrix(0,i-1,o,e.columns-1),h=t.subMatrix(i,t.rows-1,0,o-1),c=e.subMatrix(i,e.rows-1,0,o-1),f=t.subMatrix(i,t.rows-1,o,t.columns-1),m=e.subMatrix(i,e.rows-1,o,e.columns-1),p=blockMult(AbstractMatrix.add(s,f),AbstractMatrix.add(a,m),i,o),g=blockMult(AbstractMatrix.add(h,f),a,i,o),d=blockMult(s,AbstractMatrix.sub(l,m),i,o),y=blockMult(f,AbstractMatrix.sub(c,a),i,o),w=blockMult(AbstractMatrix.add(s,u),m,i,o),v=blockMult(AbstractMatrix.sub(h,s),AbstractMatrix.add(a,l),i,o),b=blockMult(AbstractMatrix.sub(u,f),AbstractMatrix.add(c,m),i,o),x=AbstractMatrix.add(p,y);x.sub(w),x.add(b);let M=AbstractMatrix.add(d,w),_=AbstractMatrix.add(g,y),S=AbstractMatrix.sub(p,g);S.add(d),S.add(v);let k=AbstractMatrix.zeros(2*x.rows,2*x.columns);return(k=(k=(k=(k=k.setSubMatrix(x,0,0)).setSubMatrix(M,x.rows,0)).setSubMatrix(_,0,x.columns)).setSubMatrix(S,x.rows,x.columns)).subMatrix(0,r-1,0,n-1)}return blockMult(e=embed(e,s,a),t=embed(t,s,a),s,a)}scaleRows(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw TypeError("min must be a number");if(!Number.isFinite(r))throw TypeError("max must be a number");if(e>=r)throw RangeError("min must be smaller than max");let n=new Matrix(this.rows,this.columns);for(let t=0;t<this.rows;t++){let o=this.getRow(t);o.length>0&&i(o,{min:e,max:r,output:o}),n.setRow(t,o)}return n}scaleColumns(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw TypeError("min must be a number");if(!Number.isFinite(r))throw TypeError("max must be a number");if(e>=r)throw RangeError("min must be smaller than max");let n=new Matrix(this.rows,this.columns);for(let t=0;t<this.columns;t++){let o=this.getColumn(t);o.length&&i(o,{min:e,max:r,output:o}),n.setColumn(t,o)}return n}flipRows(){let t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){let t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=Matrix.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,i=t.columns,o=new Matrix(e*n,r*i);for(let s=0;s<e;s++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let a=0;a<i;a++)o.set(n*s+r,i*e+a,this.get(s,e)*t.get(r,a));return o}kroneckerSum(t){if(t=Matrix.checkMatrix(t),!this.isSquare()||!t.isSquare())throw Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(Matrix.eye(r,r)),i=Matrix.eye(e,e).kroneckerProduct(t);return n.add(i)}transpose(){let t=new Matrix(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=compareNumbers){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=compareNumbers){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){checkRange(this,t,e,r,n);let i=new Matrix(e-t+1,n-r+1);for(let o=t;o<=e;o++)for(let e=r;e<=n;e++)i.set(o-t,e-r,this.get(o,e));return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw RangeError("Argument out of range");let n=new Matrix(t.length,r-e+1);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.rows)throw RangeError(`Row index out of range: ${t[i]}`);n.set(i,o-e,this.get(t[i],o))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw RangeError("Argument out of range");let n=new Matrix(r-e+1,t.length);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.columns)throw RangeError(`Column index out of range: ${t[i]}`);n.set(o-e,i,this.get(o,t[i]))}return n}setSubMatrix(t,e,r){if((t=Matrix.checkMatrix(t)).isEmpty())return this;let n=e+t.rows-1,i=r+t.columns-1;checkRange(this,e,n,r,i);for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)this.set(e+n,r+i,t.get(n,i));return this}selection(t,e){checkRowIndices(this,t),checkColumnIndices(this,e);let r=new Matrix(t.length,e.length);for(let n=0;n<t.length;n++){let i=t[n];for(let t=0;t<e.length;t++){let o=e[t];r.set(n,t,this.get(i,o))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new Matrix(this.rows,this.columns))}static copy(t,e){for(let[r,n,i]of t.entries())e.set(r,n,i);return e}sum(t){switch(t){case"row":return sumByRow(this);case"column":return sumByColumn(this);case void 0:return sumAll(this);default:throw Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return productByRow(this);case"column":return productByColumn(this);case void 0:return productAll(this);default:throw Error(`invalid option: ${t}`)}}mean(t){let e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let{unbiased:r=!0,mean:i=this.mean(t)}=e;if("boolean"!=typeof r)throw TypeError("unbiased must be a boolean");switch(t){case"row":if(!n.isAnyArray(i))throw TypeError("mean must be an array");return varianceByRow(this,r,i);case"column":if(!n.isAnyArray(i))throw TypeError("mean must be an array");return varianceByColumn(this,r,i);case void 0:if("number"!=typeof i)throw TypeError("mean must be a number");return varianceAll(this,r,i);default:throw Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);let r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let{center:r=this.mean(t)}=e;switch(t){case"row":if(!n.isAnyArray(r))throw TypeError("center must be an array");return centerByRow(this,r),this;case"column":if(!n.isAnyArray(r))throw TypeError("center must be an array");return centerByColumn(this,r),this;case void 0:if("number"!=typeof r)throw TypeError("center must be a number");return centerAll(this,r),this;default:throw Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=getScaleByRow(this);else if(!n.isAnyArray(r))throw TypeError("scale must be an array");return scaleByRow(this,r),this;case"column":if(void 0===r)r=getScaleByColumn(this);else if(!n.isAnyArray(r))throw TypeError("scale must be an array");return scaleByColumn(this,r),this;case void 0:if(void 0===r)r=getScaleAll(this);else if("number"!=typeof r)throw TypeError("scale must be a number");return scaleAll(this,r),this;default:throw Error(`invalid option: ${t}`)}}toString(t){return inspectMatrixWithOptions(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}};function compareNumbers(t,e){return t-e}function isArrayOfNumbers(t){return t.every(t=>"number"==typeof t)}AbstractMatrix.prototype.klass="Matrix","undefined"!=typeof Symbol&&(AbstractMatrix.prototype[Symbol.for("nodejs.util.inspect.custom")]=inspectMatrix),AbstractMatrix.random=AbstractMatrix.rand,AbstractMatrix.randomInt=AbstractMatrix.randInt,AbstractMatrix.diagonal=AbstractMatrix.diag,AbstractMatrix.prototype.diagonal=AbstractMatrix.prototype.diag,AbstractMatrix.identity=AbstractMatrix.eye,AbstractMatrix.prototype.negate=AbstractMatrix.prototype.neg,AbstractMatrix.prototype.tensorProduct=AbstractMatrix.prototype.kroneckerProduct;let Matrix=class Matrix extends AbstractMatrix{data;#t(t,e){if(this.data=[],Number.isInteger(e)&&e>=0)for(let r=0;r<t;r++)this.data.push(new Float64Array(e));else throw TypeError("nColumns must be a positive integer");this.rows=t,this.columns=e}constructor(t,e){if(super(),Matrix.isMatrix(t))this.#t(t.rows,t.columns),Matrix.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else if(n.isAnyArray(t)){let r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw RangeError("Inconsistent array dimensions");if(!isArrayOfNumbers(r[n]))throw TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}this.rows=t,this.columns=e}else throw TypeError("First argument must be a positive number or an array")}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return checkRowIndex(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),checkRowIndex(this,t,!0),e=Float64Array.from(checkRowVector(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){checkColumnIndex(this,t);for(let e=0;e<this.rows;e++){let r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),checkColumnIndex(this,t,!0),e=checkColumnVector(this,e);for(let r=0;r<this.rows;r++){let n=new Float64Array(this.columns+1),i=0;for(;i<t;i++)n[i]=this.data[r][i];for(n[i++]=e[r];i<this.columns+1;i++)n[i]=this.data[r][i-1];this.data[r]=n}return this.columns+=1,this}};installMathOperations(AbstractMatrix,Matrix);let SymmetricMatrix=class SymmetricMatrix extends AbstractMatrix{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return Matrix.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),Matrix.isMatrix(t)){if(!t.isSymmetric())throw TypeError("not symmetric data");this.#e=Matrix.copy(t,new Matrix(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new Matrix(t,t);else if(this.#e=new Matrix(t),!this.isSymmetric())throw TypeError("not symmetric data")}clone(){let t=new SymmetricMatrix(this.diagonalSize);for(let[e,r,n]of this.upperRightEntries())t.set(e,r,n);return t}toMatrix(){return new Matrix(this)}get(t,e){return this.#e.get(t,e)}set(t,e,r){return this.#e.set(t,e,r),this.#e.set(e,t,r),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);let r=e.slice();return r.splice(t,1),this.#e.addRow(t,r),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw RangeError("Mask size do not match with matrix size");let e=[];for(let[r,n]of t.entries())n||e.push(r);for(let t of(e.reverse(),e))this.removeCross(t);return this}toCompact(){let{diagonalSize:t}=this,e=Array(t*(t+1)/2);for(let r=0,n=0,i=0;i<e.length;i++)e[i]=this.get(n,r),++r>=t&&(r=++n);return e}static fromCompact(t){let e=t.length,r=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(r))throw TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);let n=new SymmetricMatrix(r);for(let i=0,o=0,s=0;s<e;s++)n.set(i,o,t[s]),++i>=r&&(i=++o);return n}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;){let r=this.get(t,e);yield[t,e,r],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;){let r=this.get(t,e);yield r,++e>=this.diagonalSize&&(e=++t)}}};SymmetricMatrix.prototype.klassType="SymmetricMatrix";let DistanceMatrix=class DistanceMatrix extends SymmetricMatrix{static isDistanceMatrix(t){return SymmetricMatrix.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw TypeError("Provided arguments do no produce a distance matrix")}set(t,e,r){return t===e&&(r=0),super.set(t,e,r)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new SymmetricMatrix(this)}clone(){let t=new DistanceMatrix(this.diagonalSize);for(let[e,r,n]of this.upperRightEntries())e!==r&&t.set(e,r,n);return t}toCompact(){let{diagonalSize:t}=this,e=Array((t-1)*t/2);for(let r=1,n=0,i=0;i<e.length;i++)e[i]=this.get(n,r),++r>=t&&(r=++n+1);return e}static fromCompact(t){let e=t.length;if(0===e)return new this(0);let r=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(r))throw TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);let n=new this(r);for(let i=1,o=0,s=0;s<e;s++)n.set(i,o,t[s]),++i>=r&&(i=++o+1);return n}};DistanceMatrix.prototype.klassSubType="DistanceMatrix";let BaseView=class BaseView extends AbstractMatrix{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}};let MatrixColumnView=class MatrixColumnView extends BaseView{constructor(t,e){checkColumnIndex(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}};let MatrixColumnSelectionView=class MatrixColumnSelectionView extends BaseView{constructor(t,e){checkColumnIndices(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}};let MatrixFlipColumnView=class MatrixFlipColumnView extends BaseView{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}};let MatrixFlipRowView=class MatrixFlipRowView extends BaseView{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}};let MatrixRowView=class MatrixRowView extends BaseView{constructor(t,e){checkRowIndex(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}};let MatrixRowSelectionView=class MatrixRowSelectionView extends BaseView{constructor(t,e){checkRowIndices(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}};let MatrixSelectionView=class MatrixSelectionView extends BaseView{constructor(t,e,r){checkRowIndices(t,e),checkColumnIndices(t,r),super(t,e.length,r.length),this.rowIndices=e,this.columnIndices=r}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}};let MatrixSubView=class MatrixSubView extends BaseView{constructor(t,e,r,n,i){checkRange(t,e,r,n,i),super(t,r-e+1,i-n+1),this.startRow=e,this.startColumn=n}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}};let MatrixTransposeView=class MatrixTransposeView extends BaseView{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}};let WrapperMatrix1D=class WrapperMatrix1D extends AbstractMatrix{constructor(t,e={}){let{rows:r=1}=e;if(t.length%r!=0)throw Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let n=this._calculateIndex(t,e);return this.data[n]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}};let WrapperMatrix2D=class WrapperMatrix2D extends AbstractMatrix{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}};function wrap(t,e){if(n.isAnyArray(t))return t[0]&&n.isAnyArray(t[0])?new WrapperMatrix2D(t):new WrapperMatrix1D(t,e);throw Error("the argument is not an array")}let LuDecomposition=class LuDecomposition{constructor(t){let e,r,n,i,o,s,a,u,l;let h=(t=WrapperMatrix2D.checkMatrix(t)).clone(),c=h.rows,f=h.columns,m=new Float64Array(c),p=1;for(e=0;e<c;e++)m[e]=e;for(r=0,u=new Float64Array(c);r<f;r++){for(e=0;e<c;e++)u[e]=h.get(e,r);for(e=0;e<c;e++){for(n=0,l=Math.min(e,r),o=0;n<l;n++)o+=h.get(e,n)*u[n];u[e]-=o,h.set(e,r,u[e])}for(i=r,e=r+1;e<c;e++)Math.abs(u[e])>Math.abs(u[i])&&(i=e);if(i!==r){for(n=0;n<f;n++)s=h.get(i,n),h.set(i,n,h.get(r,n)),h.set(r,n,s);a=m[i],m[i]=m[r],m[r]=a,p=-p}if(r<c&&0!==h.get(r,r))for(e=r+1;e<c;e++)h.set(e,r,h.get(e,r)/h.get(r,r))}this.LU=h,this.pivotVector=m,this.pivotSign=p}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){let e,r,n;t=Matrix.checkMatrix(t);let i=this.LU;if(i.rows!==t.rows)throw Error("Invalid matrix dimensions");if(this.isSingular())throw Error("LU matrix is singular");let o=t.columns,s=t.subMatrixRow(this.pivotVector,0,o-1),a=i.columns;for(n=0;n<a;n++)for(e=n+1;e<a;e++)for(r=0;r<o;r++)s.set(e,r,s.get(e,r)-s.get(n,r)*i.get(e,n));for(n=a-1;n>=0;n--){for(r=0;r<o;r++)s.set(n,r,s.get(n,r)/i.get(n,n));for(e=0;e<n;e++)for(r=0;r<o;r++)s.set(e,r,s.get(e,r)-s.get(n,r)*i.get(e,n))}return s}get determinant(){let t=this.LU;if(!t.isSquare())throw Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let n=0;n<r;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new Matrix(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i>e?n.set(i,e,t.get(i,e)):i===e?n.set(i,e,1):n.set(i,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new Matrix(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i<=e?n.set(i,e,t.get(i,e)):n.set(i,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}};function hypotenuse(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}let QrDecomposition=class QrDecomposition{constructor(t){let e,r,n,i;let o=(t=WrapperMatrix2D.checkMatrix(t)).clone(),s=t.rows,a=t.columns,u=new Float64Array(a);for(n=0;n<a;n++){let t=0;for(e=n;e<s;e++)t=hypotenuse(t,o.get(e,n));if(0!==t){for(0>o.get(n,n)&&(t=-t),e=n;e<s;e++)o.set(e,n,o.get(e,n)/t);for(o.set(n,n,o.get(n,n)+1),r=n+1;r<a;r++){for(i=0,e=n;e<s;e++)i+=o.get(e,n)*o.get(e,r);for(i=-i/o.get(n,n),e=n;e<s;e++)o.set(e,r,o.get(e,r)+i*o.get(e,n))}}u[n]=-t}this.QR=o,this.Rdiag=u}solve(t){let e,r,n,i;t=Matrix.checkMatrix(t);let o=this.QR,s=o.rows;if(t.rows!==s)throw Error("Matrix row dimensions must agree");if(!this.isFullRank())throw Error("Matrix is rank deficient");let a=t.columns,u=t.clone(),l=o.columns;for(n=0;n<l;n++)for(r=0;r<a;r++){for(i=0,e=n;e<s;e++)i+=o.get(e,n)*u.get(e,r);for(i=-i/o.get(n,n),e=n;e<s;e++)u.set(e,r,u.get(e,r)+i*o.get(e,n))}for(n=l-1;n>=0;n--){for(r=0;r<a;r++)u.set(n,r,u.get(n,r)/this.Rdiag[n]);for(e=0;e<n;e++)for(r=0;r<a;r++)u.set(e,r,u.get(e,r)-u.get(n,r)*o.get(e,n))}return u.subMatrix(0,l-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,n=r.columns,i=new Matrix(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?i.set(t,e,r.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,r,n,i=this.QR,o=i.rows,s=i.columns,a=new Matrix(o,s);for(r=s-1;r>=0;r--){for(t=0;t<o;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<s;e++)if(0!==i.get(r,r)){for(n=0,t=r;t<o;t++)n+=i.get(t,r)*a.get(t,e);for(n=-n/i.get(r,r),t=r;t<o;t++)a.set(t,e,a.get(t,e)+n*i.get(t,r))}}return a}};let SingularValueDecomposition=class SingularValueDecomposition{constructor(t,e={}){let r;if((t=WrapperMatrix2D.checkMatrix(t)).isEmpty())throw Error("Matrix must be non-empty");let n=t.rows,i=t.columns,{computeLeftSingularVectors:o=!0,computeRightSingularVectors:s=!0,autoTranspose:a=!1}=e,u=!!o,l=!!s,h=!1;if(n<i){if(a){n=(r=t.transpose()).rows,i=r.columns,h=!0;let e=u;u=l,l=e}else r=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose")}else r=t.clone();let c=Math.min(n,i),f=Math.min(n+1,i),m=new Float64Array(f),p=new Matrix(n,c),g=new Matrix(i,i),d=new Float64Array(i),y=new Float64Array(n),w=new Float64Array(f);for(let t=0;t<f;t++)w[t]=t;let v=Math.min(n-1,i),b=Math.max(0,Math.min(i-2,n)),x=Math.max(v,b);for(let t=0;t<x;t++){if(t<v){m[t]=0;for(let e=t;e<n;e++)m[t]=hypotenuse(m[t],r.get(e,t));if(0!==m[t]){0>r.get(t,t)&&(m[t]=-m[t]);for(let e=t;e<n;e++)r.set(e,t,r.get(e,t)/m[t]);r.set(t,t,r.get(t,t)+1)}m[t]=-m[t]}for(let e=t+1;e<i;e++){if(t<v&&0!==m[t]){let i=0;for(let o=t;o<n;o++)i+=r.get(o,t)*r.get(o,e);i=-i/r.get(t,t);for(let o=t;o<n;o++)r.set(o,e,r.get(o,e)+i*r.get(o,t))}d[e]=r.get(t,e)}if(u&&t<v)for(let e=t;e<n;e++)p.set(e,t,r.get(e,t));if(t<b){d[t]=0;for(let e=t+1;e<i;e++)d[t]=hypotenuse(d[t],d[e]);if(0!==d[t]){d[t+1]<0&&(d[t]=0-d[t]);for(let e=t+1;e<i;e++)d[e]/=d[t];d[t+1]+=1}if(d[t]=-d[t],t+1<n&&0!==d[t]){for(let e=t+1;e<n;e++)y[e]=0;for(let e=t+1;e<n;e++)for(let n=t+1;n<i;n++)y[e]+=d[n]*r.get(e,n);for(let e=t+1;e<i;e++){let i=-d[e]/d[t+1];for(let o=t+1;o<n;o++)r.set(o,e,r.get(o,e)+i*y[o])}}if(l)for(let e=t+1;e<i;e++)g.set(e,t,d[e])}}let M=Math.min(i,n+1);if(v<i&&(m[v]=r.get(v,v)),n<M&&(m[M-1]=0),b+1<M&&(d[b]=r.get(b,M-1)),d[M-1]=0,u){for(let t=v;t<c;t++){for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}for(let t=v-1;t>=0;t--)if(0!==m[t]){for(let e=t+1;e<c;e++){let r=0;for(let i=t;i<n;i++)r+=p.get(i,t)*p.get(i,e);r=-r/p.get(t,t);for(let i=t;i<n;i++)p.set(i,e,p.get(i,e)+r*p.get(i,t))}for(let e=t;e<n;e++)p.set(e,t,-p.get(e,t));p.set(t,t,1+p.get(t,t));for(let e=0;e<t-1;e++)p.set(e,t,0)}else{for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}}if(l)for(let t=i-1;t>=0;t--){if(t<b&&0!==d[t])for(let e=t+1;e<i;e++){let r=0;for(let n=t+1;n<i;n++)r+=g.get(n,t)*g.get(n,e);r=-r/g.get(t+1,t);for(let n=t+1;n<i;n++)g.set(n,e,g.get(n,e)+r*g.get(n,t))}for(let e=0;e<i;e++)g.set(e,t,0);g.set(t,t,1)}let _=M-1,S=Number.EPSILON;for(;M>0;){let t,e;for(t=M-2;t>=-1&&-1!==t;t--){let e=Number.MIN_VALUE+S*Math.abs(m[t]+Math.abs(m[t+1]));if(Math.abs(d[t])<=e||Number.isNaN(d[t])){d[t]=0;break}}if(t===M-2)e=4;else{let r;for(r=M-1;r>=t&&r!==t;r--){let e=(r!==M?Math.abs(d[r]):0)+(r!==t+1?Math.abs(d[r-1]):0);if(Math.abs(m[r])<=S*e){m[r]=0;break}}r===t?e=3:r===M-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=d[M-2];d[M-2]=0;for(let r=M-2;r>=t;r--){let n=hypotenuse(m[r],e),o=m[r]/n,s=e/n;if(m[r]=n,r!==t&&(e=-s*d[r-1],d[r-1]=o*d[r-1]),l)for(let t=0;t<i;t++)n=o*g.get(t,r)+s*g.get(t,M-1),g.set(t,M-1,-s*g.get(t,r)+o*g.get(t,M-1)),g.set(t,r,n)}break}case 2:{let e=d[t-1];d[t-1]=0;for(let r=t;r<M;r++){let i=hypotenuse(m[r],e),o=m[r]/i,s=e/i;if(m[r]=i,e=-s*d[r],d[r]=o*d[r],u)for(let e=0;e<n;e++)i=o*p.get(e,r)+s*p.get(e,t-1),p.set(e,t-1,-s*p.get(e,r)+o*p.get(e,t-1)),p.set(e,r,i)}break}case 3:{let e=Math.max(Math.abs(m[M-1]),Math.abs(m[M-2]),Math.abs(d[M-2]),Math.abs(m[t]),Math.abs(d[t])),r=m[M-1]/e,o=m[M-2]/e,s=d[M-2]/e,a=m[t]/e,h=d[t]/e,c=((o+r)*(o-r)+s*s)/2,f=r*s*(r*s),y=0;(0!==c||0!==f)&&(y=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),y=f/(c+y));let w=(a+r)*(a-r)+y,v=a*h;for(let e=t;e<M-1;e++){let r=hypotenuse(w,v);0===r&&(r=Number.MIN_VALUE);let o=w/r,s=v/r;if(e!==t&&(d[e-1]=r),w=o*m[e]+s*d[e],d[e]=o*d[e]-s*m[e],v=s*m[e+1],m[e+1]=o*m[e+1],l)for(let t=0;t<i;t++)r=o*g.get(t,e)+s*g.get(t,e+1),g.set(t,e+1,-s*g.get(t,e)+o*g.get(t,e+1)),g.set(t,e,r);if(0===(r=hypotenuse(w,v))&&(r=Number.MIN_VALUE),o=w/r,s=v/r,m[e]=r,w=o*d[e]+s*m[e+1],m[e+1]=-s*d[e]+o*m[e+1],v=s*d[e+1],d[e+1]=o*d[e+1],u&&e<n-1)for(let t=0;t<n;t++)r=o*p.get(t,e)+s*p.get(t,e+1),p.set(t,e+1,-s*p.get(t,e)+o*p.get(t,e+1)),p.set(t,e,r)}d[M-2]=w;break}case 4:if(m[t]<=0&&(m[t]=m[t]<0?-m[t]:0,l))for(let e=0;e<=_;e++)g.set(e,t,-g.get(e,t));for(;t<_&&!(m[t]>=m[t+1]);){let e=m[t];if(m[t]=m[t+1],m[t+1]=e,l&&t<i-1)for(let r=0;r<i;r++)e=g.get(r,t+1),g.set(r,t+1,g.get(r,t)),g.set(r,t,e);if(u&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);t++}M--}}if(h){let t=g;g=p,p=t}this.m=n,this.n=i,this.s=m,this.U=p,this.V=g}solve(t){let e=this.threshold,r=this.s.length,n=Matrix.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=e?n.set(t,t,0):n.set(t,t,1/this.s[t]);let i=this.U,o=this.rightSingularVectors,s=o.mmul(n),a=o.rows,u=i.rows,l=Matrix.zeros(a,u);for(let t=0;t<a;t++)for(let e=0;e<u;e++){let n=0;for(let o=0;o<r;o++)n+=s.get(t,o)*i.get(e,o);l.set(t,e,n)}return l.mmul(t)}solveForDiagonal(t){return this.solve(Matrix.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,i=new Matrix(r,this.s.length);for(let o=0;o<r;o++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&i.set(o,r,t.get(o,r)/this.s[r]);let o=this.U,s=o.rows,a=o.columns,u=new Matrix(r,s);for(let t=0;t<r;t++)for(let e=0;e<s;e++){let r=0;for(let n=0;n<a;n++)r+=i.get(t,n)*o.get(e,n);u.set(t,e,r)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,i=r.length;n<i;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Matrix.diag(this.s)}};function inverse(t,e=!1){return(t=WrapperMatrix2D.checkMatrix(t),e)?new SingularValueDecomposition(t).inverse():solve(t,Matrix.eye(t.rows))}function solve(t,e,r=!1){return(t=WrapperMatrix2D.checkMatrix(t),e=WrapperMatrix2D.checkMatrix(e),r)?new SingularValueDecomposition(t).solve(e):t.isSquare()?new LuDecomposition(t).solve(e):new QrDecomposition(t).solve(e)}function determinant(t){if((t=Matrix.checkMatrix(t)).isSquare()){let e,r,n;if(0===t.columns)return 1;if(2===t.columns)return e=t.get(0,0),r=t.get(0,1),n=t.get(1,0),e*t.get(1,1)-r*n;if(3!==t.columns)return new LuDecomposition(t).determinant;{let i,o,s;return i=new MatrixSelectionView(t,[1,2],[1,2]),o=new MatrixSelectionView(t,[1,2],[0,2]),s=new MatrixSelectionView(t,[1,2],[0,1]),e=t.get(0,0),r=t.get(0,1),n=t.get(0,2),e*determinant(i)-r*determinant(o)+n*determinant(s)}}throw Error("determinant can only be calculated for a square matrix")}function xrange(t,e){let r=[];for(let n=0;n<t;n++)n!==e&&r.push(n);return r}function dependenciesOneRow(t,e,r,n=1e-9,i=1e-9){if(t>i)return Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<n&&t.set(e,0,0);return t.to1DArray()}}function linearDependencies(t,e={}){let{thresholdValue:r=1e-9,thresholdError:n=1e-9}=e,i=(t=Matrix.checkMatrix(t)).rows,o=new Matrix(i,i);for(let e=0;e<i;e++){let s=Matrix.columnVector(t.getRow(e)),a=t.subMatrixRow(xrange(i,e)).transpose(),u=new SingularValueDecomposition(a).solve(s),l=Matrix.sub(s,a.mmul(u)).abs().max();o.setRow(e,dependenciesOneRow(l,u,e,r,n))}return o}function pseudoInverse(t,e=Number.EPSILON){if((t=Matrix.checkMatrix(t)).isEmpty())return t.transpose();let r=new SingularValueDecomposition(t,{autoTranspose:!0}),n=r.leftSingularVectors,i=r.rightSingularVectors,o=r.diagonal;for(let t=0;t<o.length;t++)Math.abs(o[t])>e?o[t]=1/o[t]:o[t]=0;return i.mmul(Matrix.diag(o).mmul(n.transpose()))}function covariance(t,e=t,r={}){t=new Matrix(t);let i=!1;if("object"!=typeof e||Matrix.isMatrix(e)||n.isAnyArray(e)?e=new Matrix(e):(r=e,e=t,i=!0),t.rows!==e.rows)throw TypeError("Both matrices must have the same number of rows");let{center:o=!0}=r;o&&(t=t.center("column"),i||(e=e.center("column")));let s=t.transpose().mmul(e);for(let e=0;e<s.rows;e++)for(let r=0;r<s.columns;r++)s.set(e,r,s.get(e,r)*(1/(t.rows-1)));return s}function correlation(t,e=t,r={}){t=new Matrix(t);let i=!1;if("object"!=typeof e||Matrix.isMatrix(e)||n.isAnyArray(e)?e=new Matrix(e):(r=e,e=t,i=!0),t.rows!==e.rows)throw TypeError("Both matrices must have the same number of rows");let{center:o=!0,scale:s=!0}=r;o&&(t.center("column"),i||e.center("column")),s&&(t.scale("column"),i||e.scale("column"));let a=t.standardDeviation("column",{unbiased:!0}),u=i?a:e.standardDeviation("column",{unbiased:!0}),l=t.transpose().mmul(e);for(let e=0;e<l.rows;e++)for(let r=0;r<l.columns;r++)l.set(e,r,l.get(e,r)*(1/(a[e]*u[r]))*(1/(t.rows-1)));return l}let EigenvalueDecomposition=class EigenvalueDecomposition{constructor(t,e={}){let r,n;let{assumeSymmetric:i=!1}=e;if(!(t=WrapperMatrix2D.checkMatrix(t)).isSquare())throw Error("Matrix is not a square matrix");if(t.isEmpty())throw Error("Matrix must be non-empty");let o=t.columns,s=new Matrix(o,o),a=new Float64Array(o),u=new Float64Array(o),l=t;if(i||t.isSymmetric()){for(r=0;r<o;r++)for(n=0;n<o;n++)s.set(r,n,l.get(r,n));tred2(o,u,a,s),tql2(o,u,a,s)}else{let t=new Matrix(o,o),e=new Float64Array(o);for(n=0;n<o;n++)for(r=0;r<o;r++)t.set(r,n,l.get(r,n));orthes(o,t,e,s),hqr2(o,u,a,s,t)}this.n=o,this.e=u,this.d=a,this.V=s}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,n=this.e,i=this.d,o=new Matrix(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)o.set(t,e,0);o.set(t,t,i[t]),n[t]>0?o.set(t,t+1,n[t]):n[t]<0&&o.set(t,t-1,n[t])}return o}};function tred2(t,e,r,n){let i,o,s,a,u,l,h,c;for(u=0;u<t;u++)r[u]=n.get(t-1,u);for(a=t-1;a>0;a--){for(l=0,c=0,s=0;l<a;l++)c+=Math.abs(r[l]);if(0===c)for(u=0,e[a]=r[a-1];u<a;u++)r[u]=n.get(a-1,u),n.set(a,u,0),n.set(u,a,0);else{for(l=0;l<a;l++)r[l]/=c,s+=r[l]*r[l];for(i=r[a-1],o=Math.sqrt(s),i>0&&(o=-o),e[a]=c*o,s-=i*o,r[a-1]=i-o,u=0;u<a;u++)e[u]=0;for(u=0;u<a;u++){for(i=r[u],n.set(u,a,i),o=e[u]+n.get(u,u)*i,l=u+1;l<=a-1;l++)o+=n.get(l,u)*r[l],e[l]+=n.get(l,u)*i;e[u]=o}for(u=0,i=0;u<a;u++)e[u]/=s,i+=e[u]*r[u];for(u=0,h=i/(s+s);u<a;u++)e[u]-=h*r[u];for(u=0;u<a;u++){for(i=r[u],o=e[u],l=u;l<=a-1;l++)n.set(l,u,n.get(l,u)-(i*e[l]+o*r[l]));r[u]=n.get(a-1,u),n.set(a,u,0)}}r[a]=s}for(a=0;a<t-1;a++){if(n.set(t-1,a,n.get(a,a)),n.set(a,a,1),0!==(s=r[a+1])){for(l=0;l<=a;l++)r[l]=n.get(l,a+1)/s;for(u=0;u<=a;u++){for(l=0,o=0;l<=a;l++)o+=n.get(l,a+1)*n.get(l,u);for(l=0;l<=a;l++)n.set(l,u,n.get(l,u)-o*r[l])}}for(l=0;l<=a;l++)n.set(l,a+1,0)}for(u=0;u<t;u++)r[u]=n.get(t-1,u),n.set(t-1,u,0);n.set(t-1,t-1,1),e[0]=0}function tql2(t,e,r,n){let i,o,s,a,u,l,h,c,f,m,p,g,d,y,w,v;for(s=1;s<t;s++)e[s-1]=e[s];e[t-1]=0;let b=0,x=0,M=Number.EPSILON;for(l=0;l<t;l++){for(x=Math.max(x,Math.abs(r[l])+Math.abs(e[l])),h=l;h<t&&!(Math.abs(e[h])<=M*x);)h++;if(h>l)do{for(i=r[l],f=hypotenuse(c=(r[l+1]-i)/(2*e[l]),1),c<0&&(f=-f),r[l]=e[l]/(c+f),r[l+1]=e[l]*(c+f),m=r[l+1],o=i-r[l],s=l+2;s<t;s++)r[s]-=o;for(b+=o,c=r[h],g=p=1,d=p,y=e[l+1],w=0,v=0,s=h-1;s>=l;s--)for(u=0,d=g,g=p,v=w,i=p*e[s],o=p*c,f=hypotenuse(c,e[s]),e[s+1]=w*f,w=e[s]/f,c=(p=c/f)*r[s]-w*i,r[s+1]=o+w*(p*i+w*r[s]);u<t;u++)o=n.get(u,s+1),n.set(u,s+1,w*n.get(u,s)+p*o),n.set(u,s,p*n.get(u,s)-w*o);c=-w*v*d*y*e[l]/m,e[l]=w*c,r[l]=p*c}while(Math.abs(e[l])>M*x);r[l]=r[l]+b,e[l]=0}for(s=0;s<t-1;s++){for(u=s,c=r[s],a=s+1;a<t;a++)r[a]<c&&(u=a,c=r[a]);if(u!==s)for(a=0,r[u]=r[s],r[s]=c;a<t;a++)c=n.get(a,s),n.set(a,s,n.get(a,u)),n.set(a,u,c)}}function orthes(t,e,r,n){let i,o,s,a,u,l,h;let c=t-1;for(l=1;l<=c-1;l++){for(h=0,a=l;a<=c;a++)h+=Math.abs(e.get(a,l-1));if(0!==h){for(s=0,a=c;a>=l;a--)r[a]=e.get(a,l-1)/h,s+=r[a]*r[a];for(o=Math.sqrt(s),r[l]>0&&(o=-o),s-=r[l]*o,r[l]=r[l]-o,u=l;u<t;u++){for(i=0,a=c;a>=l;a--)i+=r[a]*e.get(a,u);for(i/=s,a=l;a<=c;a++)e.set(a,u,e.get(a,u)-i*r[a])}for(a=0;a<=c;a++){for(i=0,u=c;u>=l;u--)i+=r[u]*e.get(a,u);for(i/=s,u=l;u<=c;u++)e.set(a,u,e.get(a,u)-i*r[u])}r[l]=h*r[l],e.set(l,l-1,h*o)}}for(a=0;a<t;a++)for(u=0;u<t;u++)n.set(a,u,a===u?1:0);for(l=c-1;l>=1;l--)if(0!==e.get(l,l-1)){for(a=l+1;a<=c;a++)r[a]=e.get(a,l-1);for(u=l;u<=c;u++){for(o=0,a=l;a<=c;a++)o+=r[a]*n.get(a,u);for(o=o/r[l]/e.get(l,l-1),a=l;a<=c;a++)n.set(a,u,n.get(a,u)+o*r[a])}}}function hqr2(t,e,r,n,i){let o,s,a,u,l,h,c,f,m,p,g,d,y,w,v,b=t-1,x=t-1,M=Number.EPSILON,_=0,S=0,k=0,A=0,E=0,N=0,R=0,z=0;for(o=0;o<t;o++)for((o<0||o>x)&&(r[o]=i.get(o,o),e[o]=0),s=Math.max(o-1,0);s<t;s++)S+=Math.abs(i.get(o,s));for(;b>=0;){for(u=b;u>0&&(0===(N=Math.abs(i.get(u-1,u-1))+Math.abs(i.get(u,u)))&&(N=S),!(Math.abs(i.get(u,u-1))<M*N));)u--;if(u===b)i.set(b,b,i.get(b,b)+_),r[b]=i.get(b,b),e[b]=0,b--,z=0;else if(u===b-1){if(c=i.get(b,b-1)*i.get(b-1,b),R=Math.sqrt(Math.abs(A=(k=(i.get(b-1,b-1)-i.get(b,b))/2)*k+c)),i.set(b,b,i.get(b,b)+_),i.set(b-1,b-1,i.get(b-1,b-1)+_),f=i.get(b,b),A>=0){for(R=k>=0?k+R:k-R,r[b-1]=f+R,r[b]=r[b-1],0!==R&&(r[b]=f-c/R),e[b-1]=0,e[b]=0,N=Math.abs(f=i.get(b,b-1))+Math.abs(R),E=Math.sqrt((k=f/N)*k+(A=R/N)*A),k/=E,A/=E,s=b-1;s<t;s++)R=i.get(b-1,s),i.set(b-1,s,A*R+k*i.get(b,s)),i.set(b,s,A*i.get(b,s)-k*R);for(o=0;o<=b;o++)R=i.get(o,b-1),i.set(o,b-1,A*R+k*i.get(o,b)),i.set(o,b,A*i.get(o,b)-k*R);for(o=0;o<=x;o++)R=n.get(o,b-1),n.set(o,b-1,A*R+k*n.get(o,b)),n.set(o,b,A*n.get(o,b)-k*R)}else r[b-1]=f+k,r[b]=f+k,e[b-1]=R,e[b]=-R;b-=2,z=0}else{if(f=i.get(b,b),m=0,c=0,u<b&&(m=i.get(b-1,b-1),c=i.get(b,b-1)*i.get(b-1,b)),10===z){for(_+=f,o=0;o<=b;o++)i.set(o,o,i.get(o,o)-f);f=m=.75*(N=Math.abs(i.get(b,b-1))+Math.abs(i.get(b-1,b-2))),c=-.4375*N*N}if(30===z&&(N=(N=(m-f)/2)*N+c)>0){for(N=Math.sqrt(N),m<f&&(N=-N),N=f-c/((m-f)/2+N),o=0;o<=b;o++)i.set(o,o,i.get(o,o)-N);_+=N,f=m=c=.964}for(z+=1,l=b-2;l>=u&&(N=Math.abs(k=((E=f-(R=i.get(l,l)))*(N=m-R)-c)/i.get(l+1,l)+i.get(l,l+1))+Math.abs(A=i.get(l+1,l+1)-R-E-N)+Math.abs(E=i.get(l+2,l+1)),k/=N,A/=N,E/=N,!(l===u||Math.abs(i.get(l,l-1))*(Math.abs(A)+Math.abs(E))<M*(Math.abs(k)*(Math.abs(i.get(l-1,l-1))+Math.abs(R)+Math.abs(i.get(l+1,l+1))))));)l--;for(o=l+2;o<=b;o++)i.set(o,o-2,0),o>l+2&&i.set(o,o-3,0);for(a=l;a<=b-1&&(w=a!==b-1,a!==l&&0!==(f=Math.abs(k=i.get(a,a-1))+Math.abs(A=i.get(a+1,a-1))+Math.abs(E=w?i.get(a+2,a-1):0))&&(k/=f,A/=f,E/=f),0!==f);a++)if(N=Math.sqrt(k*k+A*A+E*E),k<0&&(N=-N),0!==N){for(a!==l?i.set(a,a-1,-N*f):u!==l&&i.set(a,a-1,-i.get(a,a-1)),k+=N,f=k/N,m=A/N,R=E/N,A/=k,E/=k,s=a;s<t;s++)k=i.get(a,s)+A*i.get(a+1,s),w&&(k+=E*i.get(a+2,s),i.set(a+2,s,i.get(a+2,s)-k*R)),i.set(a,s,i.get(a,s)-k*f),i.set(a+1,s,i.get(a+1,s)-k*m);for(o=0;o<=Math.min(b,a+3);o++)k=f*i.get(o,a)+m*i.get(o,a+1),w&&(k+=R*i.get(o,a+2),i.set(o,a+2,i.get(o,a+2)-k*E)),i.set(o,a,i.get(o,a)-k),i.set(o,a+1,i.get(o,a+1)-k*A);for(o=0;o<=x;o++)k=f*n.get(o,a)+m*n.get(o,a+1),w&&(k+=R*n.get(o,a+2),n.set(o,a+2,n.get(o,a+2)-k*E)),n.set(o,a,n.get(o,a)-k),n.set(o,a+1,n.get(o,a+1)-k*A)}}}if(0!==S){for(b=t-1;b>=0;b--)if(k=r[b],0===(A=e[b]))for(u=b,i.set(b,b,1),o=b-1;o>=0;o--){for(c=i.get(o,o)-k,E=0,s=u;s<=b;s++)E+=i.get(o,s)*i.get(s,b);if(e[o]<0)R=c,N=E;else if(u=o,0===e[o]?i.set(o,b,0!==c?-E/c:-E/(M*S)):(f=i.get(o,o+1),m=i.get(o+1,o),h=(f*N-R*E)/(A=(r[o]-k)*(r[o]-k)+e[o]*e[o]),i.set(o,b,h),i.set(o+1,b,Math.abs(f)>Math.abs(R)?(-E-c*h)/f:(-N-m*h)/R)),M*(h=Math.abs(i.get(o,b)))*h>1)for(s=o;s<=b;s++)i.set(s,b,i.get(s,b)/h)}else if(A<0)for(u=b-1,Math.abs(i.get(b,b-1))>Math.abs(i.get(b-1,b))?(i.set(b-1,b-1,A/i.get(b,b-1)),i.set(b-1,b,-(i.get(b,b)-k)/i.get(b,b-1))):(v=cdiv(0,-i.get(b-1,b),i.get(b-1,b-1)-k,A),i.set(b-1,b-1,v[0]),i.set(b-1,b,v[1])),i.set(b,b-1,0),i.set(b,b,1),o=b-2;o>=0;o--){for(p=0,g=0,s=u;s<=b;s++)p+=i.get(o,s)*i.get(s,b-1),g+=i.get(o,s)*i.get(s,b);if(c=i.get(o,o)-k,e[o]<0)R=c,E=p,N=g;else if(u=o,0===e[o]?(v=cdiv(-p,-g,c,A),i.set(o,b-1,v[0]),i.set(o,b,v[1])):(f=i.get(o,o+1),m=i.get(o+1,o),d=(r[o]-k)*(r[o]-k)+e[o]*e[o]-A*A,y=(r[o]-k)*2*A,0===d&&0===y&&(d=M*S*(Math.abs(c)+Math.abs(A)+Math.abs(f)+Math.abs(m)+Math.abs(R))),v=cdiv(f*E-R*p+A*g,f*N-R*g-A*p,d,y),i.set(o,b-1,v[0]),i.set(o,b,v[1]),Math.abs(f)>Math.abs(R)+Math.abs(A)?(i.set(o+1,b-1,(-p-c*i.get(o,b-1)+A*i.get(o,b))/f),i.set(o+1,b,(-g-c*i.get(o,b)-A*i.get(o,b-1))/f)):(v=cdiv(-E-m*i.get(o,b-1),-N-m*i.get(o,b),R,A),i.set(o+1,b-1,v[0]),i.set(o+1,b,v[1]))),M*(h=Math.max(Math.abs(i.get(o,b-1)),Math.abs(i.get(o,b))))*h>1)for(s=o;s<=b;s++)i.set(s,b-1,i.get(s,b-1)/h),i.set(s,b,i.get(s,b)/h)}for(o=0;o<t;o++)if(o<0||o>x)for(s=o;s<t;s++)n.set(o,s,i.get(o,s));for(s=t-1;s>=0;s--)for(o=0;o<=x;o++){for(a=0,R=0;a<=Math.min(s,x);a++)R+=n.get(o,a)*i.get(a,s);n.set(o,s,R)}}}function cdiv(t,e,r,n){let i,o;return Math.abs(r)>Math.abs(n)?(i=n/r,o=r+i*n,[(t+i*e)/o,(e-i*t)/o]):(i=r/n,o=n+i*r,[(i*t+e)/o,(i*e-t)/o])}let CholeskyDecomposition=class CholeskyDecomposition{constructor(t){let e,r,n;if(!(t=WrapperMatrix2D.checkMatrix(t)).isSymmetric())throw Error("Matrix is not symmetric");let i=t,o=i.rows,s=new Matrix(o,o),a=!0;for(r=0;r<o;r++){let t=0;for(n=0;n<r;n++){let o=0;for(e=0;e<n;e++)o+=s.get(n,e)*s.get(r,e);o=(i.get(r,n)-o)/s.get(n,n),s.set(r,n,o),t+=o*o}for(t=i.get(r,r)-t,a&&=t>0,s.set(r,r,Math.sqrt(Math.max(t,0))),n=r+1;n<o;n++)s.set(r,n,0)}this.L=s,this.positiveDefinite=a}isPositiveDefinite(){return this.positiveDefinite}solve(t){let e,r,n;t=WrapperMatrix2D.checkMatrix(t);let i=this.L,o=i.rows;if(t.rows!==o)throw Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw Error("Matrix is not positive definite");let s=t.columns,a=t.clone();for(n=0;n<o;n++)for(r=0;r<s;r++){for(e=0;e<n;e++)a.set(n,r,a.get(n,r)-a.get(e,r)*i.get(n,e));a.set(n,r,a.get(n,r)/i.get(n,n))}for(n=o-1;n>=0;n--)for(r=0;r<s;r++){for(e=n+1;e<o;e++)a.set(n,r,a.get(n,r)-a.get(e,r)*i.get(e,n));a.set(n,r,a.get(n,r)/i.get(n,n))}return a}get lowerTriangularMatrix(){return this.L}};let nipals=class nipals{constructor(t,e={}){let r,i,o,s,a;t=WrapperMatrix2D.checkMatrix(t);let{Y:u}=e,{scaleScores:l=!1,maxIterations:h=1e3,terminationCriteria:c=1e-10}=e;if(u){if((u=n.isAnyArray(u)&&"number"==typeof u[0]?Matrix.columnVector(u):WrapperMatrix2D.checkMatrix(u)).rows!==t.rows)throw Error("Y should have the same number of rows as X");r=u.getColumnVector(0)}else r=t.getColumnVector(0);let f=1;for(let e=0;e<h&&f>c;e++)s=(s=t.transpose().mmul(r).div(r.transpose().mmul(r).get(0,0))).div(s.norm()),i=t.mmul(s).div(s.transpose().mmul(s).get(0,0)),e>0&&(f=i.clone().sub(a).pow(2).sum()),a=i.clone(),u?(o=(o=u.transpose().mmul(i).div(i.transpose().mmul(i).get(0,0))).div(o.norm()),r=u.mmul(o).div(o.transpose().mmul(o).get(0,0))):r=i;if(u){let e=t.transpose().mmul(i).div(i.transpose().mmul(i).get(0,0));e=e.div(e.norm());let n=t.clone().sub(i.clone().mmul(e.transpose())),a=r.transpose().mmul(i).div(i.transpose().mmul(i).get(0,0)),l=u.clone().sub(i.clone().mulS(a.get(0,0)).mmul(o.transpose()));this.t=i,this.p=e.transpose(),this.w=s.transpose(),this.q=o,this.u=r,this.s=i.transpose().mmul(i),this.xResidual=n,this.yResidual=l,this.betas=a}else this.w=s.transpose(),this.s=i.transpose().mmul(i).sqrt(),l?this.t=i.clone().div(this.s.get(0,0)):this.t=i,this.xResidual=t.sub(i.mmul(s.transpose()))}};e.XA=AbstractMatrix,e.a_=CholeskyDecomposition,e.yQ=CholeskyDecomposition,e.Hs=DistanceMatrix,e.Ec=EigenvalueDecomposition,e.dx=EigenvalueDecomposition,e.LU=LuDecomposition,e.Rm=LuDecomposition,e.y3=Matrix,e.qK=MatrixColumnSelectionView,e.pb=MatrixColumnView,e.j=MatrixFlipColumnView,e.sO=MatrixFlipRowView,e.BZ=MatrixRowSelectionView,e.EK=MatrixRowView,e.Db=MatrixSelectionView,e.Fx=MatrixSubView,e.tU=MatrixTransposeView,e.Ym=nipals,e.rs=nipals,e.QR=QrDecomposition,e.TB=QrDecomposition,e.oH=SingularValueDecomposition,e.Sc=SingularValueDecomposition,e.BN=SymmetricMatrix,e.it=WrapperMatrix1D,e.$r=WrapperMatrix2D,e.QM=correlation,e.AV=covariance,e.GH=determinant,e.SO=inverse,e.uZ=linearDependencies,e.yU=pseudoInverse,e.F1=solve,e.re=wrap},622:function(t,e,r){/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2265),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function q(t,e,r){var n,o={},l=null,h=null;for(n in void 0!==r&&(l=""+r),void 0!==e.key&&(l=""+e.key),void 0!==e.ref&&(h=e.ref),e)s.call(e,n)&&!u.hasOwnProperty(n)&&(o[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps)void 0===o[n]&&(o[n]=e[n]);return{$$typeof:i,type:t,key:l,ref:h,props:o,_owner:a.current}}e.Fragment=o,e.jsx=q,e.jsxs=q},7437:function(t,e,r){t.exports=r(622)},8836:function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.smallestFlagged=e.deheapSort=e.buildCandidates=e.uncheckedHeapPush=e.heapPush=e.rejectionSample=e.makeHeap=void 0;var s=o(r(4127));function makeHeap(t,e){var makeArrays=function(r){return s.empty(t).map(function(){return s.filled(e,r)})},r=[];return r.push(makeArrays(-1)),r.push(makeArrays(1/0)),r.push(makeArrays(0)),r}function rejectionSample(t,e,r){for(var n=s.zeros(t),i=0;i<t;i++){for(var o=!0,a=0;o;){a=s.tauRandInt(e,r);for(var u=!1,l=0;l<i;l++)if(a===n[l]){u=!0;break}u||(o=!1)}n[i]=a}return n}function heapPush(t,e,r,n,i){e=Math.floor(e);var o=t[0][e],s=t[1][e];if(t[2][e],r>=s[0])return 0;for(var a=0;a<o.length;a++)if(n===o[a])return 0;return uncheckedHeapPush(t,e,r,n,i)}function uncheckedHeapPush(t,e,r,n,i){var o=t[0][e],s=t[1][e],a=t[2][e];if(r>=s[0])return 0;s[0]=r,o[0]=n,a[0]=i;for(var u=0,l=0;;){var h=2*u+1,c=h+1,f=t[0][0].length;if(h>=f)break;if(c>=f){if(s[h]>r)l=h;else break}else if(s[h]>=s[c]){if(r<s[h])l=h;else break}else if(r<s[c])l=c;else break;s[u]=s[l],o[u]=o[l],a[u]=a[l],u=l}return s[u]=r,o[u]=n,a[u]=i,1}function buildCandidates(t,e,r,n,i){for(var o=makeHeap(e,n),a=0;a<e;a++)for(var u=0;u<r;u++)if(!(t[0][a][u]<0)){var l=t[0][a][u],h=t[2][a][u],c=s.tauRand(i);heapPush(o,a,c,l,h),heapPush(o,l,c,a,h),t[2][a][u]=0}return o}function deheapSort(t){for(var e=t[0],r=t[1],n=0;n<e.length;n++)for(var i=e[n],o=r[n],s=0;s<i.length-1;s++){var a=i.length-s-1,u=o.length-s-1,l=i[0];i[0]=i[a],i[a]=l;var h=o[0];o[0]=o[u],o[u]=h,siftDown(o,i,u,0)}return{indices:e,weights:r}}function siftDown(t,e,r,n){for(;2*n+1<r;){var i=2*n+1,o=i+1,s=n;if(t[s]<t[i]&&(s=i),o<r&&t[s]<t[o]&&(s=o),s===n)break;var a=t[n];t[n]=t[s],t[s]=a;var u=e[n];e[n]=e[s],e[s]=u,n=s}}function smallestFlagged(t,e){for(var r=t[0][e],n=t[1][e],i=t[2][e],o=1/0,s=-1,a=0;a>r.length;a++)1===i[a]&&n[a]<o&&(o=n[a],s=a);return s>=0?(i[s]=0,Math.floor(r[s])):-1}e.makeHeap=makeHeap,e.rejectionSample=rejectionSample,e.heapPush=heapPush,e.uncheckedHeapPush=uncheckedHeapPush,e.buildCandidates=buildCandidates,e.deheapSort=deheapSort,e.smallestFlagged=smallestFlagged},1921:function(t,e,r){var n=r(3221);Object.defineProperty(e,"u",{enumerable:!0,get:function(){return n.UMAP}})},4695:function(t,e,r){var n,i=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&i(e,t,r);return o(e,t),e},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},u=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.getCSR=e.normalize=e.eliminateZeros=e.multiplyScalar=e.maximum=e.subtract=e.add=e.pairwiseMultiply=e.identity=e.transpose=e.SparseMatrix=void 0;var l=s(r(4127)),h=function(){function SparseMatrix(t,e,r,n){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==r.length)throw Error("rows, cols and values arrays must all have the same length");this.nRows=n[0],this.nCols=n[1];for(var i=0;i<r.length;i++){var o=t[i],s=e[i];this.checkDims(o,s);var a=this.makeKey(o,s);this.entries.set(a,{value:r[i],row:o,col:s})}}return SparseMatrix.prototype.makeKey=function(t,e){return t+":"+e},SparseMatrix.prototype.checkDims=function(t,e){if(!(t<this.nRows&&e<this.nCols))throw Error("row and/or col specified outside of matrix dimensions")},SparseMatrix.prototype.set=function(t,e,r){this.checkDims(t,e);var n=this.makeKey(t,e);this.entries.has(n)?this.entries.get(n).value=r:this.entries.set(n,{value:r,row:t,col:e})},SparseMatrix.prototype.get=function(t,e,r){void 0===r&&(r=0),this.checkDims(t,e);var n=this.makeKey(t,e);return this.entries.has(n)?this.entries.get(n).value:r},SparseMatrix.prototype.getAll=function(t){void 0===t&&(t=!0);var e=[];return this.entries.forEach(function(t){e.push(t)}),t&&e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row}),e},SparseMatrix.prototype.getDims=function(){return[this.nRows,this.nCols]},SparseMatrix.prototype.getRows=function(){return Array.from(this.entries,function(t){var e=a(t,2);return(e[0],e[1]).row})},SparseMatrix.prototype.getCols=function(){return Array.from(this.entries,function(t){var e=a(t,2);return(e[0],e[1]).col})},SparseMatrix.prototype.getValues=function(){return Array.from(this.entries,function(t){var e=a(t,2);return(e[0],e[1]).value})},SparseMatrix.prototype.forEach=function(t){this.entries.forEach(function(e){return t(e.value,e.row,e.col)})},SparseMatrix.prototype.map=function(t){var e=[];this.entries.forEach(function(r){e.push(t(r.value,r.row,r.col))});var r=[this.nRows,this.nCols];return new SparseMatrix(this.getRows(),this.getCols(),e,r)},SparseMatrix.prototype.toArray=function(){var t=this,e=l.empty(this.nRows).map(function(){return l.zeros(t.nCols)});return this.entries.forEach(function(t){e[t.row][t.col]=t.value}),e},SparseMatrix}();function transpose(t){var e=[],r=[],n=[];return t.forEach(function(t,i,o){e.push(i),r.push(o),n.push(t)}),new h(r,e,n,[t.nCols,t.nRows])}function identity(t){for(var e=a(t,1)[0],r=new h([],[],[],t),n=0;n<e;n++)r.set(n,n,1);return r}function pairwiseMultiply(t,e){return elementWise(t,e,function(t,e){return t*e})}function add(t,e){return elementWise(t,e,function(t,e){return t+e})}function subtract(t,e){return elementWise(t,e,function(t,e){return t-e})}function maximum(t,e){return elementWise(t,e,function(t,e){return t>e?t:e})}function multiplyScalar(t,e){return t.map(function(t){return t*e})}function eliminateZeros(t){for(var e=new Set,r=t.getValues(),n=t.getRows(),i=t.getCols(),o=0;o<r.length;o++)0===r[o]&&e.add(o);var removeByZeroIndex=function(t,r){return!e.has(r)},s=r.filter(removeByZeroIndex);return new h(n.filter(removeByZeroIndex),i.filter(removeByZeroIndex),s,t.getDims())}function normalize(t,e){void 0===e&&(e="l2");var r,n,i=c[e],o=new Map;t.forEach(function(t,e,r){var n=o.get(e)||[];n.push(r),o.set(e,n)});var s=new h([],[],[],t.getDims()),_loop_1=function(e){for(var r=o.get(e).sort(),n=i(r.map(function(r){return t.get(e,r)})),a=0;a<n.length;a++)s.set(e,r[a],n[a])};try{for(var a=u(o.keys()),l=a.next();!l.done;l=a.next()){var f=l.value;_loop_1(f)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return s}e.SparseMatrix=h,e.transpose=transpose,e.identity=identity,e.pairwiseMultiply=pairwiseMultiply,e.add=add,e.subtract=subtract,e.maximum=maximum,e.multiplyScalar=multiplyScalar,e.eliminateZeros=eliminateZeros,e.normalize=normalize;var c=((n={}).max=function(t){for(var e=-1/0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return t.map(function(t){return t/e})},n.l1=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return t.map(function(t){return t/e})},n.l2=function(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return t.map(function(t){return Math.sqrt(Math.pow(t,2)/e)})},n);function elementWise(t,e,r){for(var n=new Set,i=[],o=[],s=[],operate=function(n,a){i.push(n),o.push(a);var u=r(t.get(n,a),e.get(n,a));s.push(u)},a=t.getValues(),u=t.getRows(),l=t.getCols(),c=0;c<a.length;c++){var f=u[c],m=l[c],p=f+":"+m;n.add(p),operate(f,m)}for(var g=e.getValues(),d=e.getRows(),y=e.getCols(),c=0;c<g.length;c++){var f=d[c],m=y[c],p=f+":"+m;n.has(p)||operate(f,m)}return new h(i,o,s,[t.nRows,t.nCols])}function getCSR(t){var e=[];t.forEach(function(t,r,n){e.push({value:t,row:r,col:n})}),e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row});for(var r=[],n=[],i=[],o=-1,s=0;s<e.length;s++){var a=e[s],u=a.row,l=a.col,h=a.value;u!==o&&(o=u,i.push(s)),r.push(l),n.push(h)}return{indices:r,values:n,indptr:i}}e.getCSR=getCSR},358:function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.initializeSearch=e.makeInitializedNNSearch=e.makeInitializations=e.makeNNDescent=void 0;var a=o(r(8836)),u=o(r(4695)),l=o(r(7773)),h=o(r(4127));function makeNNDescent(t,e){return function(r,n,i,o,s,u,l,c){void 0===o&&(o=10),void 0===s&&(s=50),void 0===u&&(u=.001),void 0===l&&(l=.5),void 0===c&&(c=!0);for(var f=r.length,m=a.makeHeap(r.length,i),p=0;p<r.length;p++)for(var g=a.rejectionSample(i,r.length,e),d=0;d<g.length;d++){var y=t(r[p],r[g[d]]);a.heapPush(m,p,y,g[d],1),a.heapPush(m,g[d],y,p,1)}if(c)for(var w=0;w<n.length;w++)for(var p=0;p<n[w].length&&!(n[w][p]<0);p++)for(var d=p+1;d<n[w].length&&!(n[w][d]<0);d++){var y=t(r[n[w][p]],r[n[w][d]]);a.heapPush(m,n[w][p],y,n[w][d],1),a.heapPush(m,n[w][d],y,n[w][p],1)}for(var w=0;w<o;w++){for(var v=a.buildCandidates(m,f,i,s,e),b=0,p=0;p<f;p++)for(var d=0;d<s;d++){var x=Math.floor(v[0][p][d]);if(!(x<0||h.tauRand(e)<l))for(var M=0;M<s;M++){var _=Math.floor(v[0][p][M]),S=v[2][p][d],k=v[2][p][M];if(!(_<0)&&(S||k)){var y=t(r[x],r[_]);b+=a.heapPush(m,x,y,_,1)+a.heapPush(m,_,y,x,1)}}}if(b<=u*i*r.length)break}return a.deheapSort(m)}}function makeInitializations(t){return{initFromRandom:function(e,r,n,i,o){for(var s=0;s<n.length;s++)for(var u=h.rejectionSample(e,r.length,o),l=0;l<u.length;l++)if(!(u[l]<0)){var c=t(r[u[l]],n[s]);a.heapPush(i,s,c,u[l],1)}},initFromTree:function(e,r,n,i,o){for(var s=0;s<n.length;s++)for(var u=l.searchFlatTree(n[s],e,o),h=0;h<u.length;h++){if(u[h]<0)return;var c=t(r[u[h]],n[s]);a.heapPush(i,s,c,u[h],1)}}}}function makeInitializedNNSearch(t){return function(e,r,n,i){for(var o,l,h=u.getCSR(r),c=h.indices,f=h.indptr,m=0;m<i.length;m++)for(var p=new Set(n[0][m]);;){var g=a.smallestFlagged(n,m);if(-1===g)break;var d=c.slice(f[g],f[g+1]);try{for(var y=(o=void 0,s(d)),w=y.next();!w.done;w=y.next()){var v=w.value;if(!(v===g||-1===v||p.has(v))){var b=t(e[v],i[m]);a.uncheckedHeapPush(n,m,b,v,1),p.add(v)}}}catch(t){o={error:t}}finally{try{w&&!w.done&&(l=y.return)&&l.call(y)}finally{if(o)throw o.error}}}return n}}function initializeSearch(t,e,r,n,i,o,u){var l,h,c=a.makeHeap(r.length,n);if(i(n,e,r,c,u),t)try{for(var f=s(t),m=f.next();!m.done;m=f.next()){var p=m.value;o(p,e,r,c,u)}}catch(t){l={error:t}}finally{try{m&&!m.done&&(h=f.return)&&h.call(f)}finally{if(l)throw l.error}}return c}e.makeNNDescent=makeNNDescent,e.makeInitializations=makeInitializations,e.makeInitializedNNSearch=makeInitializedNNSearch,e.initializeSearch=initializeSearch},7773:function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},u=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.searchFlatTree=e.makeLeafArray=e.makeForest=e.FlatTree=void 0;var l=o(r(4127)),FlatTree=function(t,e,r,n){this.hyperplanes=t,this.offsets=e,this.children=r,this.indices=n};function makeForest(t,e,r,n){var i=Math.max(10,e);return l.range(r).map(function(e,r){return makeTree(t,i,r,n)}).map(function(t){return flattenTree(t,i)})}function makeTree(t,e,r,n){void 0===e&&(e=30);var i=l.range(t.length);return makeEuclideanTree(t,i,e,r,n)}function makeEuclideanTree(t,e,r,n,i){if(void 0===r&&(r=30),e.length>r){var o=euclideanRandomProjectionSplit(t,e,i),s=o.indicesLeft,a=o.indicesRight,u=o.hyperplane,l=o.offset,h={leftChild:makeEuclideanTree(t,s,r,n+1,i),rightChild:makeEuclideanTree(t,a,r,n+1,i),isLeaf:!1,hyperplane:u,offset:l};return h}var h={indices:e,isLeaf:!0};return h}function euclideanRandomProjectionSplit(t,e,r){var n=t[0].length,i=l.tauRandInt(e.length,r),o=l.tauRandInt(e.length,r);o+=i===o?1:0,o%=e.length;for(var s=e[i],a=e[o],u=0,h=l.zeros(n),c=0;c<h.length;c++)h[c]=t[s][c]-t[a][c],u-=h[c]*(t[s][c]+t[a][c])/2;for(var f=0,m=0,p=l.zeros(e.length),c=0;c<e.length;c++){for(var g=u,d=0;d<n;d++)g+=h[d]*t[e[c]][d];0===g?(p[c]=l.tauRandInt(2,r),0===p[c]?f+=1:m+=1):g>0?(p[c]=0,f+=1):(p[c]=1,m+=1)}var y=l.zeros(f),w=l.zeros(m);f=0,m=0;for(var c=0;c<p.length;c++)0===p[c]?(y[f]=e[c],f+=1):(w[m]=e[c],m+=1);return{indicesLeft:y,indicesRight:w,hyperplane:h,offset:u}}function flattenTree(t,e){var r=numNodes(t),n=numLeaves(t),i=l.range(r).map(function(){return l.zeros(t.hyperplane?t.hyperplane.length:0)}),o=l.zeros(r),s=l.range(r).map(function(){return[-1,-1]}),a=l.range(n).map(function(){return l.range(e).map(function(){return -1})});return recursiveFlatten(t,i,o,s,a,0,0),new FlatTree(i,o,s,a)}function recursiveFlatten(t,e,r,n,i,o,s){if(t.isLeaf)return n[o][0]=-s,(u=i[s]).splice.apply(u,a([0,t.indices.length],t.indices)),{nodeNum:o,leafNum:s+=1};e[o]=t.hyperplane,r[o]=t.offset,n[o][0]=o+1;var u,l=o,h=recursiveFlatten(t.leftChild,e,r,n,i,o+1,s);return o=h.nodeNum,s=h.leafNum,n[l][1]=o+1,{nodeNum:(h=recursiveFlatten(t.rightChild,e,r,n,i,o+1,s)).nodeNum,leafNum:h.leafNum}}function numNodes(t){return t.isLeaf?1:1+numNodes(t.leftChild)+numNodes(t.rightChild)}function numLeaves(t){return t.isLeaf?1:numLeaves(t.leftChild)+numLeaves(t.rightChild)}function makeLeafArray(t){if(!(t.length>0))return[[-1]];var e,r,n=[];try{for(var i=u(t),o=i.next();!o.done;o=i.next()){var s=o.value;n.push.apply(n,a(s.indices))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function selectSide(t,e,r,n){for(var i=e,o=0;o<r.length;o++)i+=t[o]*r[o];return 0===i?l.tauRandInt(2,n):i>0?0:1}function searchFlatTree(t,e,r){for(var n=0;e.children[n][0]>0;)n=0===selectSide(e.hyperplanes[n],e.offsets[n],t,r)?e.children[n][0]:e.children[n][1];var i=-1*e.children[n][0];return e.indices[i]}e.FlatTree=FlatTree,e.makeForest=makeForest,e.makeLeafArray=makeLeafArray,e.searchFlatTree=searchFlatTree},3221:function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e},s=this&&this.__awaiter||function(t,e,r,n){function adopt(t){return t instanceof r?t:new r(function(e){e(t)})}return new(r||(r=Promise))(function(r,i){function fulfilled(t){try{step(n.next(t))}catch(t){i(t)}}function rejected(t){try{step(n.throw(t))}catch(t){i(t)}}function step(t){t.done?r(t.value):adopt(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(t){return function(e){return step([t,e])}}function step(o){if(r)throw TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},u=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},l=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(u(arguments[e]));return t},h=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.initTransform=e.resetLocalConnectivity=e.fastIntersection=e.findABParams=e.cosine=e.euclidean=e.UMAP=void 0;var c=o(r(8836)),f=o(r(4695)),m=o(r(358)),p=o(r(7773)),g=o(r(4127)),d=h(r(5024)),y=function(){function UMAP(t){var e=this;void 0===t&&(t={}),this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=euclidean,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new OptimizationState;var setParam=function(r){void 0!==t[r]&&(e[r]=t[r])};setParam("distanceFn"),setParam("learningRate"),setParam("localConnectivity"),setParam("minDist"),setParam("nComponents"),setParam("nEpochs"),setParam("nNeighbors"),setParam("negativeSampleRate"),setParam("random"),setParam("repulsionStrength"),setParam("setOpMixRatio"),setParam("spread"),setParam("transformQueueSize")}return UMAP.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},UMAP.prototype.fitAsync=function(t,e){return void 0===e&&(e=function(){return!0}),s(this,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return this.initializeFit(t),[4,this.optimizeLayoutAsync(e)];case 1:return r.sent(),[2,this.embedding]}})})},UMAP.prototype.setSupervisedProjection=function(t,e){void 0===e&&(e={}),this.Y=t,this.targetMetric=e.targetMetric||this.targetMetric,this.targetWeight=e.targetWeight||this.targetWeight,this.targetNNeighbors=e.targetNNeighbors||this.targetNNeighbors},UMAP.prototype.setPrecomputedKNN=function(t,e){this.knnIndices=t,this.knnDistances=e},UMAP.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw Error("Not enough data points ("+t.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===t&&this.isInitialized)return this.getNEpochs();if(this.X=t,!this.knnIndices&&!this.knnDistances){var e=this.nearestNeighbors(t);this.knnIndices=e.knnIndices,this.knnDistances=e.knnDistances}this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(t),this.processGraphForSupervisedProjection();var r=this.initializeSimplicialSetEmbedding(),n=r.head,i=r.tail,o=r.epochsPerSample;return this.optimizationState.head=n,this.optimizationState.tail=i,this.optimizationState.epochsPerSample=o,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},UMAP.prototype.makeSearchFns=function(){var t=m.makeInitializations(this.distanceFn),e=t.initFromTree,r=t.initFromRandom;this.initFromTree=e,this.initFromRandom=r,this.search=m.makeInitializedNNSearch(this.distanceFn)},UMAP.prototype.makeSearchGraph=function(t){for(var e=this.knnIndices,r=this.knnDistances,n=[t.length,t.length],i=new f.SparseMatrix([],[],[],n),o=0;o<e.length;o++)for(var s=e[o],a=r[o],u=0;u<s.length;u++){var l=s[u],h=a[u];h>0&&i.set(o,l,h)}var c=f.transpose(i);return f.maximum(i,c)},UMAP.prototype.transform=function(t){var e=this,r=this.X;if(void 0===r||0===r.length)throw Error("No data has been fit.");var n=Math.floor(this.nNeighbors*this.transformQueueSize);n=Math.min(r.length,n);var i=m.initializeSearch(this.rpForest,r,t,n,this.initFromRandom,this.initFromTree,this.random),o=this.search(r,this.searchGraph,i,t),s=c.deheapSort(o),a=s.indices,u=s.weights;a=a.map(function(t){return t.slice(0,e.nNeighbors)}),u=u.map(function(t){return t.slice(0,e.nNeighbors)});var l=Math.max(0,this.localConnectivity-1),h=this.smoothKNNDistance(u,this.nNeighbors,l),p=h.sigmas,d=h.rhos,y=this.computeMembershipStrengths(a,u,p,d),w=y.rows,v=y.cols,b=y.vals,x=[t.length,r.length],M=new f.SparseMatrix(w,v,b,x),_=f.normalize(M,"l1"),S=f.getCSR(_),k=t.length,A=initTransform(g.reshape2d(S.indices,k,this.nNeighbors),g.reshape2d(S.values,k,this.nNeighbors),this.embedding),E=this.nEpochs?this.nEpochs/3:M.nRows<=1e4?100:30,N=M.getValues().reduce(function(t,e){return e>t?e:t},0);M=M.map(function(t){return t<N/E?0:t}),M=f.eliminateZeros(M);var R=this.makeEpochsPerSample(M.getValues(),E),z=M.getRows(),C=M.getCols();return this.assignOptimizationStateParameters({headEmbedding:A,tailEmbedding:this.embedding,head:z,tail:C,currentEpoch:0,nEpochs:E,nVertices:M.getDims()[1],epochsPerSample:R}),this.prepareForOptimizationLoop(),this.optimizeLayout()},UMAP.prototype.processGraphForSupervisedProjection=function(){var t=this.Y,e=this.X;if(t){if(t.length!==e.length)throw Error("Length of X and y must be equal");if("categorical"===this.targetMetric){var r=this.targetWeight<1?2.5*(1/(1-this.targetWeight)):1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,t,r)}}},UMAP.prototype.step=function(){var t=this.optimizationState.currentEpoch;return t<this.getNEpochs()&&this.optimizeLayoutStep(t),this.optimizationState.currentEpoch},UMAP.prototype.getEmbedding=function(){return this.embedding},UMAP.prototype.nearestNeighbors=function(t){var e,r=this.distanceFn,n=this.nNeighbors,i=m.makeNNDescent(r,this.random),o=5+Math.floor(.5==(e=Math.pow(t.length,.5)/20)?0:Math.round(e)),s=Math.max(5,Math.floor(Math.round(Math.log(t.length)/Math.log(2))));this.rpForest=p.makeForest(t,n,o,this.random);var a=i(t,p.makeLeafArray(this.rpForest),n,s);return{knnIndices:a.indices,knnDistances:a.weights}},UMAP.prototype.fuzzySimplicialSet=function(t,e,r){void 0===r&&(r=1);var n=this.knnIndices,i=this.knnDistances,o=void 0===i?[]:i,s=this.localConnectivity,a=this.smoothKNNDistance(o,e,s),u=a.sigmas,l=a.rhos,h=this.computeMembershipStrengths(void 0===n?[]:n,o,u,l),c=h.rows,m=h.cols,p=h.vals,g=[t.length,t.length],d=new f.SparseMatrix(c,m,p,g),y=f.transpose(d),w=f.pairwiseMultiply(d,y),v=f.subtract(f.add(d,y),w),b=f.multiplyScalar(v,r),x=f.multiplyScalar(w,1-r);return f.add(b,x)},UMAP.prototype.categoricalSimplicialSetIntersection=function(t,e,r,n){void 0===n&&(n=1);var i=fastIntersection(t,e,n,r);return resetLocalConnectivity(i=f.eliminateZeros(i))},UMAP.prototype.smoothKNNDistance=function(t,e,r,n,i){void 0===r&&(r=1),void 0===n&&(n=64),void 0===i&&(i=1);for(var o=Math.log(e)/Math.log(2)*i,s=g.zeros(t.length),a=g.zeros(t.length),u=0;u<t.length;u++){var l=0,h=1/0,c=1,f=t[u],m=f.filter(function(t){return t>0});if(m.length>=r){var p=Math.floor(r),d=r-p;p>0?(s[u]=m[p-1],d>1e-5&&(s[u]+=d*(m[p]-m[p-1]))):s[u]=d*m[0]}else m.length>0&&(s[u]=g.max(m));for(var y=0;y<n;y++){for(var w=0,v=1;v<t[u].length;v++){var b=t[u][v]-s[u];b>0?w+=Math.exp(-(b/c)):w+=1}if(1e-5>Math.abs(w-o))break;w>o?c=(l+(h=c))/2:(l=c,h===1/0?c*=2:c=(l+h)/2)}if(a[u]=c,s[u]>0){var x=g.mean(f);a[u]<.001*x&&(a[u]=.001*x)}else{var M=g.mean(t.map(g.mean));a[u]<.001*M&&(a[u]=.001*M)}}return{sigmas:a,rhos:s}},UMAP.prototype.computeMembershipStrengths=function(t,e,r,n){for(var i=t.length,o=t[0].length,s=g.zeros(i*o),a=g.zeros(i*o),u=g.zeros(i*o),l=0;l<i;l++)for(var h=0;h<o;h++){var c=0;-1!==t[l][h]&&(c=t[l][h]===l?0:e[l][h]-n[l]<=0?1:Math.exp(-((e[l][h]-n[l])/r[l])),s[l*o+h]=l,a[l*o+h]=t[l][h],u[l*o+h]=c)}return{rows:s,cols:a,vals:u}},UMAP.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),r=this.nComponents,n=this.graph.getValues(),i=0,o=0;o<n.length;o++){var s=n[o];i<n[o]&&(i=s)}var a=this.graph.map(function(t){return t<i/e?0:t});this.embedding=g.zeros(a.nRows).map(function(){return g.zeros(r).map(function(){return 20*g.tauRand(t.random)+-10})});for(var u=[],l=[],h=[],c=a.getAll(),o=0;o<c.length;o++){var f=c[o];f.value&&(u.push(f.value),h.push(f.row),l.push(f.col))}return{head:l,tail:h,epochsPerSample:this.makeEpochsPerSample(u,e)}},UMAP.prototype.makeEpochsPerSample=function(t,e){var r=g.filled(t.length,-1),n=g.max(t),i=t.map(function(t){return t/n*e});return i.forEach(function(t,n){t>0&&(r[n]=e/i[n])}),r},UMAP.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},UMAP.prototype.prepareForOptimizationLoop=function(){var t=this.repulsionStrength,e=this.learningRate,r=this.negativeSampleRate,n=this.optimizationState,i=n.epochsPerSample,o=n.headEmbedding,s=n.tailEmbedding,a=o[0].length,u=o.length===s.length,h=i.map(function(t){return t/r}),c=l(h),f=l(i);this.assignOptimizationStateParameters({epochOfNextSample:f,epochOfNextNegativeSample:c,epochsPerNegativeSample:h,moveOther:u,initialAlpha:e,alpha:e,gamma:t,dim:a})},UMAP.prototype.initializeOptimization=function(){var t=this.embedding,e=this.embedding,r=this.optimizationState,n=r.head,i=r.tail,o=r.epochsPerSample,s=this.getNEpochs(),a=this.graph.nCols,u=findABParams(this.spread,this.minDist),l=u.a,h=u.b;this.assignOptimizationStateParameters({headEmbedding:t,tailEmbedding:e,head:n,tail:i,epochsPerSample:o,a:l,b:h,nEpochs:s,nVertices:a})},UMAP.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,r=e.head,n=e.tail,i=e.headEmbedding,o=e.tailEmbedding,s=e.epochsPerSample,a=e.epochOfNextSample,u=e.epochOfNextNegativeSample,l=e.epochsPerNegativeSample,h=e.moveOther,c=e.initialAlpha,f=e.alpha,m=e.gamma,p=e.a,d=e.b,y=e.dim,w=e.nEpochs,v=e.nVertices,b=0;b<s.length;b++)if(!(a[b]>t)){var x=r[b],M=n[b],_=i[x],S=o[M],k=rDist(_,S),A=0;k>0&&(A=-2*p*d*Math.pow(k,d-1)/(p*Math.pow(k,d)+1));for(var E=0;E<y;E++){var N=clip(A*(_[E]-S[E]),4);_[E]+=N*f,h&&(S[E]+=-N*f)}a[b]+=s[b];for(var R=Math.floor((t-u[b])/l[b]),z=0;z<R;z++){var C=g.tauRandInt(v,this.random),T=o[C],I=rDist(_,T),P=0;if(I>0)P=2*m*d/((.001+I)*(p*Math.pow(I,d)+1));else if(x===C)continue;for(var E=0;E<y;E++){var N=4;P>0&&(N=clip(P*(_[E]-T[E]),4)),_[E]+=N*f}}u[b]+=R*l[b]}return e.alpha=c*(1-t/w),e.currentEpoch+=1,i},UMAP.prototype.optimizeLayoutAsync=function(t){var e=this;return void 0===t&&(t=function(){return!0}),new Promise(function(r,n){var step=function(){return s(e,void 0,void 0,function(){var e,i,o,s,u,l;return a(this,function(a){try{if(i=(e=this.optimizationState).nEpochs,o=e.currentEpoch,this.embedding=this.optimizeLayoutStep(o),s=this.optimizationState.currentEpoch,u=!1===t(s),l=s===i,u||l)return[2,r(l)];setTimeout(function(){return step()},0)}catch(t){n(t)}return[2]})})};setTimeout(function(){return step()},0)})},UMAP.prototype.optimizeLayout=function(t){void 0===t&&(t=function(){return!0});for(var e=!1,r=[];!e;){var n=this.optimizationState,i=n.nEpochs,o=n.currentEpoch;r=this.optimizeLayoutStep(o);var s=this.optimizationState.currentEpoch,a=!1===t(s);e=s===i||a}return r},UMAP.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;return e<=2500?500:e<=5e3?400:e<=7500?300:200},UMAP}();function euclidean(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return Math.sqrt(r)}function cosine(t,e){for(var r=0,n=0,i=0,o=0;o<t.length;o++)r+=t[o]*e[o],n+=Math.pow(t[o],2),i+=Math.pow(e[o],2);return 0===n&&0===i?0:0===n||0===i?1:1-r/Math.sqrt(n*i)}e.UMAP=y,e.euclidean=euclidean,e.cosine=cosine;var OptimizationState=function(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0};function clip(t,e){return t>e?e:t<-e?-e:t}function rDist(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r}function findABParams(t,e){var r=g.linear(0,3*t,300).map(function(t){return t<e?1:t}),n=g.zeros(r.length).map(function(n,i){return r[i]>=e?Math.exp(-(r[i]-e)/t):n}),i=d.default({x:r,y:n},function(t){var e=u(t,2),r=e[0],n=e[1];return function(t){return 1/(1+r*Math.pow(t,2*n))}},{damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01}).parameterValues,o=u(i,2);return{a:o[0],b:o[1]}}function fastIntersection(t,e,r,n){return void 0===r&&(r=1),void 0===n&&(n=5),t.map(function(t,i,o){return -1===e[i]||-1===e[o]?t*Math.exp(-r):e[i]!==e[o]?t*Math.exp(-n):t})}function resetLocalConnectivity(t){t=f.normalize(t,"max");var e=f.transpose(t),r=f.pairwiseMultiply(e,t);return t=f.add(t,f.subtract(e,r)),f.eliminateZeros(t)}function initTransform(t,e,r){for(var n=g.zeros(t.length).map(function(t){return g.zeros(r[0].length)}),i=0;i<t.length;i++)for(var o=0;o<t[0].length;o++)for(var s=0;s<r[0].length;s++){var a=t[i][o];n[i][s]+=e[i][o]*r[a][s]}return n}e.findABParams=findABParams,e.fastIntersection=fastIntersection,e.resetLocalConnectivity=resetLocalConnectivity,e.initTransform=initTransform},4127:function(t,e){var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function tauRandInt(t,e){return Math.floor(e()*t)}function tauRand(t){return t()}function norm(t){var e,n,i=0;try{for(var o=r(t),s=o.next();!s.done;s=o.next()){var a=s.value;i+=Math.pow(a,2)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return Math.sqrt(i)}function empty(t){for(var e=[],r=0;r<t;r++)e.push(void 0);return e}function range(t){return empty(t).map(function(t,e){return e})}function filled(t,e){return empty(t).map(function(){return e})}function zeros(t){return filled(t,0)}function ones(t){return filled(t,1)}function linear(t,e,r){return empty(r).map(function(n,i){return t+i*((e-t)/(r-1))})}function sum(t){return t.reduce(function(t,e){return t+e})}function mean(t){return sum(t)/t.length}function max(t){for(var e=0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return e}function max2d(t){for(var e=0,r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)e=t[r][n]>e?t[r][n]:e;return e}function rejectionSample(t,e,r){for(var n=zeros(t),i=0;i<t;i++)for(var o=!0;o;){for(var s=tauRandInt(e,r),a=!1,u=0;u<i;u++)if(s===n[u]){a=!0;break}a||(o=!1),n[i]=s}return n}function reshape2d(t,e,r){var n=[],i=0;if(t.length!==e*r)throw Error("Array dimensions must match input length.");for(var o=0;o<e;o++){for(var s=[],a=0;a<r;a++)s.push(t[i]),i+=1;n.push(s)}return n}Object.defineProperty(e,"__esModule",{value:!0}),e.reshape2d=e.rejectionSample=e.max2d=e.max=e.mean=e.sum=e.linear=e.ones=e.zeros=e.filled=e.range=e.empty=e.norm=e.tauRand=e.tauRandInt=void 0,e.tauRandInt=tauRandInt,e.tauRand=tauRand,e.norm=norm,e.empty=empty,e.range=range,e.filled=filled,e.zeros=zeros,e.ones=ones,e.linear=linear,e.sum=sum,e.mean=mean,e.max=max,e.max2d=max2d,e.rejectionSample=rejectionSample,e.reshape2d=reshape2d},1620:function(t,e,r){function extent(t,e){let r,n;if(void 0===e)for(let e of t)null!=e&&(void 0===r?e>=e&&(r=n=e):(r>e&&(r=e),n<e&&(n=e)));else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(void 0===r?o>=o&&(r=n=o):(r>o&&(r=o),n<o&&(n=o)))}return[r,n]}function none(){}function selector(t){return null==t?none:function(){return this.querySelector(t)}}function selection_select(t){"function"!=typeof t&&(t=selector(t));for(var e=this._groups,r=e.length,n=Array(r),i=0;i<r;++i)for(var o,s,a=e[i],u=a.length,l=n[i]=Array(u),h=0;h<u;++h)(o=a[h])&&(s=t.call(o,o.__data__,h,a))&&("__data__"in o&&(s.__data__=o.__data__),l[h]=s);return new Selection(n,this._parents)}function array(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function empty(){return[]}function selectorAll(t){return null==t?empty:function(){return this.querySelectorAll(t)}}function arrayAll(t){return function(){return array(t.apply(this,arguments))}}function selectAll(t){t="function"==typeof t?arrayAll(t):selectorAll(t);for(var e=this._groups,r=e.length,n=[],i=[],o=0;o<r;++o)for(var s,a=e[o],u=a.length,l=0;l<u;++l)(s=a[l])&&(n.push(t.call(s,s.__data__,l,a)),i.push(s));return new Selection(n,i)}function matcher(t){return function(){return this.matches(t)}}function childMatcher(t){return function(e){return e.matches(t)}}r.d(e,{Wem:function(){return extent},cx$:function(){return src_pointer},BYU:function(){return linear_linear},PKp:function(){return ordinal},Cn1:function(){return tc},Ys:function(){return src_select},sPX:function(){return zoom}});var n,i,o,s,a,u=Array.prototype.find;function childFind(t){return function(){return u.call(this.children,t)}}function childFirst(){return this.firstElementChild}function selectChild(t){return this.select(null==t?childFirst:childFind("function"==typeof t?t:childMatcher(t)))}var l=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(t){return function(){return l.call(this.children,t)}}function selectChildren(t){return this.selectAll(null==t?children:childrenFilter("function"==typeof t?t:childMatcher(t)))}function selection_filter(t){"function"!=typeof t&&(t=matcher(t));for(var e=this._groups,r=e.length,n=Array(r),i=0;i<r;++i)for(var o,s=e[i],a=s.length,u=n[i]=[],l=0;l<a;++l)(o=s[l])&&t.call(o,o.__data__,l,s)&&u.push(o);return new Selection(n,this._parents)}function sparse(t){return Array(t.length)}function enter(){return new Selection(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function src_constant(t){return function(){return t}}function bindIndex(t,e,r,n,i,o){for(var s,a=0,u=e.length,l=o.length;a<l;++a)(s=e[a])?(s.__data__=o[a],n[a]=s):r[a]=new EnterNode(t,o[a]);for(;a<u;++a)(s=e[a])&&(i[a]=s)}function bindKey(t,e,r,n,i,o,s){var a,u,l,h=new Map,c=e.length,f=o.length,m=Array(c);for(a=0;a<c;++a)(u=e[a])&&(m[a]=l=s.call(u,u.__data__,a,e)+"",h.has(l)?i[a]=u:h.set(l,u));for(a=0;a<f;++a)l=s.call(t,o[a],a,o)+"",(u=h.get(l))?(n[a]=u,u.__data__=o[a],h.delete(l)):r[a]=new EnterNode(t,o[a]);for(a=0;a<c;++a)(u=e[a])&&h.get(m[a])===u&&(i[a]=u)}function datum(t){return t.__data__}function data(t,e){if(!arguments.length)return Array.from(this,datum);var r=e?bindKey:bindIndex,n=this._parents,i=this._groups;"function"!=typeof t&&(t=src_constant(t));for(var o=i.length,s=Array(o),a=Array(o),u=Array(o),l=0;l<o;++l){var h=n[l],c=i[l],f=c.length,m=arraylike(t.call(h,h&&h.__data__,l,n)),p=m.length,g=a[l]=Array(p),d=s[l]=Array(p);r(h,c,g,d,u[l]=Array(f),m,e);for(var y,w,v=0,b=0;v<p;++v)if(y=g[v]){for(v>=b&&(b=v+1);!(w=d[b])&&++b<p;);y._next=w||null}}return(s=new Selection(s,n))._enter=a,s._exit=u,s}function arraylike(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function exit(){return new Selection(this._exit||this._groups.map(sparse),this._parents)}function join(t,e,r){var n=this.enter(),i=this,o=this.exit();return"function"==typeof t?(n=t(n))&&(n=n.selection()):n=n.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==r?o.remove():r(o),n&&i?n.merge(i).order():i}function merge(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,o=n.length,s=Math.min(i,o),a=Array(i),u=0;u<s;++u)for(var l,h=r[u],c=n[u],f=h.length,m=a[u]=Array(f),p=0;p<f;++p)(l=h[p]||c[p])&&(m[p]=l);for(;u<i;++u)a[u]=r[u];return new Selection(a,this._parents)}function order(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n,i=t[e],o=i.length-1,s=i[o];--o>=0;)(n=i[o])&&(s&&4^n.compareDocumentPosition(s)&&s.parentNode.insertBefore(n,s),s=n);return this}function sort(t){function compareNode(e,r){return e&&r?t(e.__data__,r.__data__):!e-!r}t||(t=ascending);for(var e=this._groups,r=e.length,n=Array(r),i=0;i<r;++i){for(var o,s=e[i],a=s.length,u=n[i]=Array(a),l=0;l<a;++l)(o=s[l])&&(u[l]=o);u.sort(compareNode)}return new Selection(n,this._parents).order()}function ascending(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function call(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function nodes(){return Array.from(this)}function node(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,o=n.length;i<o;++i){var s=n[i];if(s)return s}return null}function size(){let t=0;for(let e of this)++t;return t}function selection_empty(){return!this.node()}function each(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i,o=e[r],s=0,a=o.length;s<a;++s)(i=o[s])&&t.call(i,i.__data__,s,o);return this}EnterNode.prototype={constructor:EnterNode,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var h="http://www.w3.org/1999/xhtml",c={svg:"http://www.w3.org/2000/svg",xhtml:h,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(t){var e=t+="",r=e.indexOf(":");return r>=0&&"xmlns"!==(e=t.slice(0,r))&&(t=t.slice(r+1)),c.hasOwnProperty(e)?{space:c[e],local:t}:t}function attrRemove(t){return function(){this.removeAttribute(t)}}function attrRemoveNS(t){return function(){this.removeAttributeNS(t.space,t.local)}}function attrConstant(t,e){return function(){this.setAttribute(t,e)}}function attrConstantNS(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function attrFunction(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttribute(t):this.setAttribute(t,r)}}function attrFunctionNS(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function attr(t,e){var r=namespace(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((null==e?r.local?attrRemoveNS:attrRemove:"function"==typeof e?r.local?attrFunctionNS:attrFunction:r.local?attrConstantNS:attrConstant)(r,e))}function src_window(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function styleRemove(t){return function(){this.style.removeProperty(t)}}function styleConstant(t,e,r){return function(){this.style.setProperty(t,e,r)}}function styleFunction(t,e,r){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function style(t,e,r){return arguments.length>1?this.each((null==e?styleRemove:"function"==typeof e?styleFunction:styleConstant)(t,e,null==r?"":r)):styleValue(this.node(),t)}function styleValue(t,e){return t.style.getPropertyValue(e)||src_window(t).getComputedStyle(t,null).getPropertyValue(e)}function propertyRemove(t){return function(){delete this[t]}}function propertyConstant(t,e){return function(){this[t]=e}}function propertyFunction(t,e){return function(){var r=e.apply(this,arguments);null==r?delete this[t]:this[t]=r}}function property(t,e){return arguments.length>1?this.each((null==e?propertyRemove:"function"==typeof e?propertyFunction:propertyConstant)(t,e)):this.node()[t]}function classArray(t){return t.trim().split(/^|\s+/)}function classList(t){return t.classList||new ClassList(t)}function ClassList(t){this._node=t,this._names=classArray(t.getAttribute("class")||"")}function classedAdd(t,e){for(var r=classList(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function classedRemove(t,e){for(var r=classList(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function classedTrue(t){return function(){classedAdd(this,t)}}function classedFalse(t){return function(){classedRemove(this,t)}}function classedFunction(t,e){return function(){(e.apply(this,arguments)?classedAdd:classedRemove)(this,t)}}function classed(t,e){var r=classArray(t+"");if(arguments.length<2){for(var n=classList(this.node()),i=-1,o=r.length;++i<o;)if(!n.contains(r[i]))return!1;return!0}return this.each(("function"==typeof e?classedFunction:e?classedTrue:classedFalse)(r,e))}function textRemove(){this.textContent=""}function textConstant(t){return function(){this.textContent=t}}function textFunction(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function selection_text(t){return arguments.length?this.each(null==t?textRemove:("function"==typeof t?textFunction:textConstant)(t)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(t){return function(){this.innerHTML=t}}function htmlFunction(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function html(t){return arguments.length?this.each(null==t?htmlRemove:("function"==typeof t?htmlFunction:htmlConstant)(t)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function creatorInherit(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===h&&e.documentElement.namespaceURI===h?e.createElement(t):e.createElementNS(r,t)}}function creatorFixed(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function creator(t){var e=namespace(t);return(e.local?creatorFixed:creatorInherit)(e)}function append(t){var e="function"==typeof t?t:creator(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function constantNull(){return null}function insert(t,e){var r="function"==typeof t?t:creator(t),n=null==e?constantNull:"function"==typeof e?e:selector(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function remove(){var t=this.parentNode;t&&t.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function selection_cloneDeep(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function clone(t){return this.select(t?selection_cloneDeep:selection_cloneShallow)}function selection_datum(t){return arguments.length?this.property("__data__",t):this.node().__data__}function contextListener(t){return function(e){t.call(this,e,this.__data__)}}function parseTypenames(t){return t.trim().split(/^|\s+/).map(function(t){var e="",r=t.indexOf(".");return r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),{type:t,name:e}})}function onRemove(t){return function(){var e=this.__on;if(e){for(var r,n=0,i=-1,o=e.length;n<o;++n)(r=e[n],t.type&&r.type!==t.type||r.name!==t.name)?e[++i]=r:this.removeEventListener(r.type,r.listener,r.options);++i?e.length=i:delete this.__on}}}function onAdd(t,e,r){return function(){var n,i=this.__on,o=contextListener(e);if(i){for(var s=0,a=i.length;s<a;++s)if((n=i[s]).type===t.type&&n.name===t.name){this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=o,n.options=r),n.value=e;return}}this.addEventListener(t.type,o,r),n={type:t.type,name:t.name,value:e,listener:o,options:r},i?i.push(n):this.__on=[n]}}function on(t,e,r){var n,i,o=parseTypenames(t+""),s=o.length;if(arguments.length<2){var a=this.node().__on;if(a){for(var u,l=0,h=a.length;l<h;++l)for(n=0,u=a[l];n<s;++n)if((i=o[n]).type===u.type&&i.name===u.name)return u.value}return}for(n=0,a=e?onAdd:onRemove;n<s;++n)this.each(a(o[n],e,r));return this}function dispatchEvent(t,e,r){var n=src_window(t),i=n.CustomEvent;"function"==typeof i?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function dispatchConstant(t,e){return function(){return dispatchEvent(this,t,e)}}function dispatchFunction(t,e){return function(){return dispatchEvent(this,t,e.apply(this,arguments))}}function selection_dispatch(t,e){return this.each(("function"==typeof e?dispatchFunction:dispatchConstant)(t,e))}function*iterator(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n,i=t[e],o=0,s=i.length;o<s;++o)(n=i[o])&&(yield n)}ClassList.prototype={add:function(t){0>this._names.indexOf(t)&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var f=[null];function Selection(t,e){this._groups=t,this._parents=e}function selection(){return new Selection([[document.documentElement]],f)}function selection_selection(){return this}Selection.prototype=selection.prototype={constructor:Selection,select:selection_select,selectAll:selectAll,selectChild:selectChild,selectChildren:selectChildren,filter:selection_filter,data:data,enter:enter,exit:exit,join:join,merge:merge,selection:selection_selection,order:order,sort:sort,call:call,nodes:nodes,node:node,size:size,empty:selection_empty,each:each,attr:attr,style:style,property:property,classed:classed,text:selection_text,html:html,raise:selection_raise,lower:selection_lower,append:append,insert:insert,remove:selection_remove,clone:clone,datum:selection_datum,on:on,dispatch:selection_dispatch,[Symbol.iterator]:iterator};var m=selection,p={value:()=>{}};function dispatch_dispatch(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw Error("illegal type: "+t);n[t]=[]}return new Dispatch(n)}function Dispatch(t){this._=t}function dispatch_parseTypenames(t,e){return t.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");if(n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw Error("unknown type: "+t);return{type:t,name:r}})}function get(t,e){for(var r,n=0,i=t.length;n<i;++n)if((r=t[n]).name===e)return r.value}function set(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=p,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}Dispatch.prototype=dispatch_dispatch.prototype={constructor:Dispatch,on:function(t,e){var r,n=this._,i=dispatch_parseTypenames(t+"",n),o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((r=(t=i[o]).type)&&(r=get(n[r],t.name)))return r;return}if(null!=e&&"function"!=typeof e)throw Error("invalid callback: "+e);for(;++o<s;)if(r=(t=i[o]).type)n[r]=set(n[r],t.name,e);else if(null==e)for(r in n)n[r]=set(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new Dispatch(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,i=Array(r),o=0;o<r;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw Error("unknown type: "+t);for(n=this._[t],o=0,r=n.length;o<r;++o)n[o].value.apply(e,i)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw Error("unknown type: "+t);for(var n=this._[t],i=0,o=n.length;i<o;++i)n[i].value.apply(e,r)}};var g,d,y=dispatch_dispatch,w=0,v=0,b=0,x=0,M=0,_=0,S="object"==typeof performance&&performance.now?performance:Date,k="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function now(){return M||(k(clearNow),M=S.now()+_)}function clearNow(){M=0}function Timer(){this._call=this._time=this._next=null}function timer(t,e,r){var n=new Timer;return n.restart(t,e,r),n}function timerFlush(){now(),++w;for(var t,e=g;e;)(t=M-e._time)>=0&&e._call.call(void 0,t),e=e._next;--w}function wake(){M=(x=S.now())+_,w=v=0;try{timerFlush()}finally{w=0,nap(),M=0}}function poke(){var t=S.now(),e=t-x;e>1e3&&(_-=e,x=t)}function nap(){for(var t,e,r=g,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:g=e);d=t,sleep(n)}function sleep(t){!w&&(v&&(v=clearTimeout(v)),t-M>24?(t<1/0&&(v=setTimeout(wake,t-S.now()-_)),b&&(b=clearInterval(b))):(b||(x=S.now(),b=setInterval(poke,1e3)),w=1,k(wake)))}function src_timeout(t,e,r){var n=new Timer;return e=null==e?0:+e,n.restart(r=>{n.stop(),t(r+e)},e,r),n}Timer.prototype=timer.prototype={constructor:Timer,restart:function(t,e,r){if("function"!=typeof t)throw TypeError("callback is not a function");r=(null==r?now():+r)+(null==e?0:+e),this._next||d===this||(d?d._next=this:g=this,d=this),this._call=t,this._time=r,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var A=y("start","end","cancel","interrupt"),E=[];function schedule(t,e,r,n,i,o){var s=t.__transition;if(s){if(r in s)return}else t.__transition={};create(t,r,{name:e,index:n,group:i,on:A,tween:E,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function init(t,e){var r=schedule_get(t,e);if(r.state>0)throw Error("too late; already scheduled");return r}function schedule_set(t,e){var r=schedule_get(t,e);if(r.state>3)throw Error("too late; already running");return r}function schedule_get(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw Error("transition not found");return r}function create(t,e,r){var n,i=t.__transition;function schedule(t){r.state=1,r.timer.restart(start,r.delay,r.time),r.delay<=t&&start(t-r.delay)}function start(o){var s,a,u,l;if(1!==r.state)return stop();for(s in i)if((l=i[s]).name===r.name){if(3===l.state)return src_timeout(start);4===l.state?(l.state=6,l.timer.stop(),l.on.call("interrupt",t,t.__data__,l.index,l.group),delete i[s]):+s<e&&(l.state=6,l.timer.stop(),l.on.call("cancel",t,t.__data__,l.index,l.group),delete i[s])}if(src_timeout(function(){3===r.state&&(r.state=4,r.timer.restart(tick,r.delay,r.time),tick(o))}),r.state=2,r.on.call("start",t,t.__data__,r.index,r.group),2===r.state){for(s=0,r.state=3,n=Array(u=r.tween.length),a=-1;s<u;++s)(l=r.tween[s].value.call(t,t.__data__,r.index,r.group))&&(n[++a]=l);n.length=a+1}}function tick(e){for(var i=e<r.duration?r.ease.call(null,e/r.duration):(r.timer.restart(stop),r.state=5,1),o=-1,s=n.length;++o<s;)n[o].call(t,i);5===r.state&&(r.on.call("end",t,t.__data__,r.index,r.group),stop())}function stop(){for(var n in r.state=6,r.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=r,r.timer=timer(schedule,0,r.time)}function src_interrupt(t,e){var r,n,i,o=t.__transition,s=!0;if(o){for(i in e=null==e?null:e+"",o){if((r=o[i]).name!==e){s=!1;continue}n=r.state>2&&r.state<5,r.state=6,r.timer.stop(),r.on.call(n?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete o[i]}s&&delete t.__transition}}function selection_interrupt(t){return this.each(function(){src_interrupt(this,t)})}function number(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var N=180/Math.PI,R={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(t,e,r,n,i,o){var s,a,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*r+e*n)&&(r-=t*u,n-=e*u),(a=Math.sqrt(r*r+n*n))&&(r/=a,n/=a,u/=a),t*n<e*r&&(t=-t,e=-e,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*N,skewX:Math.atan(u)*N,scaleX:s,scaleY:a}}function parseSvg(t){return null==t?R:(n||(n=document.createElementNS("http://www.w3.org/2000/svg","g")),n.setAttribute("transform",t),t=n.transform.baseVal.consolidate())?decompose((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):R}function interpolateTransform(t,e,r,n){function pop(t){return t.length?t.pop()+" ":""}function translate(t,n,i,o,s,a){if(t!==i||n!==o){var u=s.push("translate(",null,e,null,r);a.push({i:u-4,x:number(t,i)},{i:u-2,x:number(n,o)})}else(i||o)&&s.push("translate("+i+e+o+r)}function rotate(t,e,r,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:r.push(pop(r)+"rotate(",null,n)-2,x:number(t,e)})):e&&r.push(pop(r)+"rotate("+e+n)}function skewX(t,e,r,i){t!==e?i.push({i:r.push(pop(r)+"skewX(",null,n)-2,x:number(t,e)}):e&&r.push(pop(r)+"skewX("+e+n)}function scale(t,e,r,n,i,o){if(t!==r||e!==n){var s=i.push(pop(i)+"scale(",null,",",null,")");o.push({i:s-4,x:number(t,r)},{i:s-2,x:number(e,n)})}else(1!==r||1!==n)&&i.push(pop(i)+"scale("+r+","+n+")")}return function(e,r){var n=[],i=[];return e=t(e),r=t(r),translate(e.translateX,e.translateY,r.translateX,r.translateY,n,i),rotate(e.rotate,r.rotate,n,i),skewX(e.skewX,r.skewX,n,i),scale(e.scaleX,e.scaleY,r.scaleX,r.scaleY,n,i),e=r=null,function(t){for(var e,r=-1,o=i.length;++r<o;)n[(e=i[r]).i]=e.x(t);return n.join("")}}}var z=interpolateTransform(function(t){let e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?R:decompose(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),C=interpolateTransform(parseSvg,", ",")",")");function tweenRemove(t,e){var r,n;return function(){var i=schedule_set(this,t),o=i.tween;if(o!==r){n=r=o;for(var s=0,a=n.length;s<a;++s)if(n[s].name===e){(n=n.slice()).splice(s,1);break}}i.tween=n}}function tweenFunction(t,e,r){var n,i;if("function"!=typeof r)throw Error();return function(){var o=schedule_set(this,t),s=o.tween;if(s!==n){i=(n=s).slice();for(var a={name:e,value:r},u=0,l=i.length;u<l;++u)if(i[u].name===e){i[u]=a;break}u===l&&i.push(a)}o.tween=i}}function tween(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n,i=schedule_get(this.node(),r).tween,o=0,s=i.length;o<s;++o)if((n=i[o]).name===t)return n.value;return null}return this.each((null==e?tweenRemove:tweenFunction)(r,t,e))}function tweenValue(t,e,r){var n=t._id;return t.each(function(){var t=schedule_set(this,n);(t.value||(t.value={}))[e]=r.apply(this,arguments)}),function(t){return schedule_get(t,n).value[e]}}function src_define(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function extend(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Color(){}var T="\\s*([+-]?\\d+)\\s*",I="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",P="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",F=/^#([0-9a-f]{3,8})$/,D=RegExp(`^rgb\\(${T},${T},${T}\\)$`),V=RegExp(`^rgb\\(${P},${P},${P}\\)$`),O=RegExp(`^rgba\\(${T},${T},${T},${I}\\)$`),j=RegExp(`^rgba\\(${P},${P},${P},${I}\\)$`),$=RegExp(`^hsl\\(${I},${P},${P}\\)$`),L=RegExp(`^hsla\\(${I},${P},${P},${I}\\)$`),B={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color_formatHex(){return this.rgb().formatHex()}function color_formatRgb(){return this.rgb().formatRgb()}function color(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=F.exec(t))?(r=e[1].length,e=parseInt(e[1],16),6===r?rgbn(e):3===r?new Rgb(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===r?rgba(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===r?rgba(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=D.exec(t))?new Rgb(e[1],e[2],e[3],1):(e=V.exec(t))?new Rgb(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=O.exec(t))?rgba(e[1],e[2],e[3],e[4]):(e=j.exec(t))?rgba(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=$.exec(t))?hsla(e[1],e[2]/100,e[3]/100,1):(e=L.exec(t))?hsla(e[1],e[2]/100,e[3]/100,e[4]):B.hasOwnProperty(t)?rgbn(B[t]):"transparent"===t?new Rgb(NaN,NaN,NaN,0):null}function rgbn(t){return new Rgb(t>>16&255,t>>8&255,255&t,1)}function rgba(t,e,r,n){return n<=0&&(t=e=r=NaN),new Rgb(t,e,r,n)}function rgbConvert(t){return(t instanceof Color||(t=color(t)),t)?new Rgb((t=t.rgb()).r,t.g,t.b,t.opacity):new Rgb}function color_rgb(t,e,r,n){return 1==arguments.length?rgbConvert(t):new Rgb(t,e,r,null==n?1:n)}function Rgb(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){let t=clampa(this.opacity);return`${1===t?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${1===t?")":`, ${t})`}`}function clampa(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function clampi(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function hex(t){return((t=clampi(t))<16?"0":"")+t.toString(16)}function hsla(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Hsl(t,e,r,n)}function hslConvert(t){if(t instanceof Hsl)return new Hsl(t.h,t.s,t.l,t.opacity);if(t instanceof Color||(t=color(t)),!t)return new Hsl;if(t instanceof Hsl)return t;var e=(t=t.rgb()).r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),o=Math.max(e,r,n),s=NaN,a=o-i,u=(o+i)/2;return a?(s=e===o?(r-n)/a+(r<n)*6:r===o?(n-e)/a+2:(e-r)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new Hsl(s,a,u,t.opacity)}function hsl(t,e,r,n){return 1==arguments.length?hslConvert(t):new Hsl(t,e,r,null==n?1:n)}function Hsl(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}function clamph(t){return(t=(t||0)%360)<0?t+360:t}function clampt(t){return Math.max(0,Math.min(1,t||0))}function hsl2rgb(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}function basis(t,e,r,n,i){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*r+(1+3*t+3*o-3*s)*n+s*i)/6}function src_basis(t){var e=t.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,e-1):Math.floor(r*e),i=t[n],o=t[n+1],s=n>0?t[n-1]:2*i-o,a=n<e-1?t[n+2]:2*o-i;return basis((r-n/e)*e,s,i,o,a)}}function basisClosed(t){var e=t.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*e),i=t[(n+e-1)%e],o=t[n%e],s=t[(n+1)%e],a=t[(n+2)%e];return basis((r-n/e)*e,i,o,s,a)}}src_define(Color,color,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return hslConvert(this).formatHsl()},formatRgb:color_formatRgb,toString:color_formatRgb}),src_define(Rgb,color_rgb,extend(Color,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new Rgb(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Rgb(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb})),src_define(Hsl,hsl,extend(Color,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new Hsl(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Hsl(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Rgb(hsl2rgb(t>=240?t-240:t+120,i,n),hsl2rgb(t,i,n),hsl2rgb(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=clampa(this.opacity);return`${1===t?"hsl(":"hsla("}${clamph(this.h)}, ${100*clampt(this.s)}%, ${100*clampt(this.l)}%${1===t?")":`, ${t})`}`}}));var d3_interpolate_src_constant=t=>()=>t;function linear(t,e){return function(r){return t+r*e}}function exponential(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function gamma(t){return 1==(t=+t)?nogamma:function(e,r){return r-e?exponential(e,r,t):d3_interpolate_src_constant(isNaN(e)?r:e)}}function nogamma(t,e){var r=e-t;return r?linear(t,r):d3_interpolate_src_constant(isNaN(t)?e:t)}var U=function rgbGamma(t){var e=gamma(t);function rgb(t,r){var n=e((t=color_rgb(t)).r,(r=color_rgb(r)).r),i=e(t.g,r.g),o=e(t.b,r.b),s=nogamma(t.opacity,r.opacity);return function(e){return t.r=n(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return rgb.gamma=rgbGamma,rgb}(1);function rgbSpline(t){return function(e){var r,n,i=e.length,o=Array(i),s=Array(i),a=Array(i);for(r=0;r<i;++r)n=color_rgb(e[r]),o[r]=n.r||0,s[r]=n.g||0,a[r]=n.b||0;return o=t(o),s=t(s),a=t(a),n.opacity=1,function(t){return n.r=o(t),n.g=s(t),n.b=a(t),n+""}}}rgbSpline(src_basis),rgbSpline(basisClosed);var H=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,W=RegExp(H.source,"g");function zero(t){return function(){return t}}function one(t){return function(e){return t(e)+""}}function string(t,e){var r,n,i,o=H.lastIndex=W.lastIndex=0,s=-1,a=[],u=[];for(t+="",e+="";(r=H.exec(t))&&(n=W.exec(e));)(i=n.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(n=n[0])?a[s]?a[s]+=n:a[++s]=n:(a[++s]=null,u.push({i:s,x:number(r,n)})),o=W.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?u[0]?one(u[0].x):zero(e):(e=u.length,function(t){for(var r,n=0;n<e;++n)a[(r=u[n]).i]=r.x(t);return a.join("")})}function transition_interpolate(t,e){var r;return("number"==typeof e?number:e instanceof color?U:(r=color(e))?(e=r,U):string)(t,e)}function attr_attrRemove(t){return function(){this.removeAttribute(t)}}function attr_attrRemoveNS(t){return function(){this.removeAttributeNS(t.space,t.local)}}function attr_attrConstant(t,e,r){var n,i,o=r+"";return function(){var s=this.getAttribute(t);return s===o?null:s===n?i:i=e(n=s,r)}}function attr_attrConstantNS(t,e,r){var n,i,o=r+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===n?i:i=e(n=s,r)}}function attr_attrFunction(t,e,r){var n,i,o;return function(){var s,a,u=r(this);return null==u?void this.removeAttribute(t):(s=this.getAttribute(t))===(a=u+"")?null:s===n&&a===i?o:(i=a,o=e(n=s,u))}}function attr_attrFunctionNS(t,e,r){var n,i,o;return function(){var s,a,u=r(this);return null==u?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local))===(a=u+"")?null:s===n&&a===i?o:(i=a,o=e(n=s,u))}}function transition_attr(t,e){var r=namespace(t),n="transform"===r?C:transition_interpolate;return this.attrTween(t,"function"==typeof e?(r.local?attr_attrFunctionNS:attr_attrFunction)(r,n,tweenValue(this,"attr."+t,e)):null==e?(r.local?attr_attrRemoveNS:attr_attrRemove)(r):(r.local?attr_attrConstantNS:attr_attrConstant)(r,n,e))}function attrInterpolate(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function attrInterpolateNS(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function attrTweenNS(t,e){var r,n;function tween(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&attrInterpolateNS(t,i)),r}return tween._value=e,tween}function attrTween(t,e){var r,n;function tween(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&attrInterpolate(t,i)),r}return tween._value=e,tween}function transition_attrTween(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw Error();var n=namespace(t);return this.tween(r,(n.local?attrTweenNS:attrTween)(n,e))}function delayFunction(t,e){return function(){init(this,t).delay=+e.apply(this,arguments)}}function delayConstant(t,e){return e=+e,function(){init(this,t).delay=e}}function delay(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?delayFunction:delayConstant)(e,t)):schedule_get(this.node(),e).delay}function durationFunction(t,e){return function(){schedule_set(this,t).duration=+e.apply(this,arguments)}}function durationConstant(t,e){return e=+e,function(){schedule_set(this,t).duration=e}}function duration(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?durationFunction:durationConstant)(e,t)):schedule_get(this.node(),e).duration}function easeConstant(t,e){if("function"!=typeof e)throw Error();return function(){schedule_set(this,t).ease=e}}function ease(t){var e=this._id;return arguments.length?this.each(easeConstant(e,t)):schedule_get(this.node(),e).ease}function easeVarying(t,e){return function(){var r=e.apply(this,arguments);if("function"!=typeof r)throw Error();schedule_set(this,t).ease=r}}function transition_easeVarying(t){if("function"!=typeof t)throw Error();return this.each(easeVarying(this._id,t))}function transition_filter(t){"function"!=typeof t&&(t=matcher(t));for(var e=this._groups,r=e.length,n=Array(r),i=0;i<r;++i)for(var o,s=e[i],a=s.length,u=n[i]=[],l=0;l<a;++l)(o=s[l])&&t.call(o,o.__data__,l,s)&&u.push(o);return new Transition(n,this._parents,this._name,this._id)}function transition_merge(t){if(t._id!==this._id)throw Error();for(var e=this._groups,r=t._groups,n=e.length,i=r.length,o=Math.min(n,i),s=Array(n),a=0;a<o;++a)for(var u,l=e[a],h=r[a],c=l.length,f=s[a]=Array(c),m=0;m<c;++m)(u=l[m]||h[m])&&(f[m]=u);for(;a<n;++a)s[a]=e[a];return new Transition(s,this._parents,this._name,this._id)}function start(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}function onFunction(t,e,r){var n,i,o=start(e)?init:schedule_set;return function(){var s=o(this,t),a=s.on;a!==n&&(i=(n=a).copy()).on(e,r),s.on=i}}function transition_on(t,e){var r=this._id;return arguments.length<2?schedule_get(this.node(),r).on.on(t):this.each(onFunction(r,t,e))}function removeFunction(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(t){var e=this._name,r=this._id;"function"!=typeof t&&(t=selector(t));for(var n=this._groups,i=n.length,o=Array(i),s=0;s<i;++s)for(var a,u,l=n[s],h=l.length,c=o[s]=Array(h),f=0;f<h;++f)(a=l[f])&&(u=t.call(a,a.__data__,f,l))&&("__data__"in a&&(u.__data__=a.__data__),c[f]=u,schedule(c[f],e,r,f,c,schedule_get(a,r)));return new Transition(o,this._parents,e,r)}function transition_selectAll(t){var e=this._name,r=this._id;"function"!=typeof t&&(t=selectorAll(t));for(var n=this._groups,i=n.length,o=[],s=[],a=0;a<i;++a)for(var u,l=n[a],h=l.length,c=0;c<h;++c)if(u=l[c]){for(var f,m=t.call(u,u.__data__,c,l),p=schedule_get(u,r),g=0,d=m.length;g<d;++g)(f=m[g])&&schedule(f,e,r,g,m,p);o.push(m),s.push(u)}return new Transition(o,s,e,r)}var X=m.prototype.constructor;function transition_selection(){return new X(this._groups,this._parents)}function styleNull(t,e){var r,n,i;return function(){var o=styleValue(this,t),s=(this.style.removeProperty(t),styleValue(this,t));return o===s?null:o===r&&s===n?i:i=e(r=o,n=s)}}function style_styleRemove(t){return function(){this.style.removeProperty(t)}}function style_styleConstant(t,e,r){var n,i,o=r+"";return function(){var s=styleValue(this,t);return s===o?null:s===n?i:i=e(n=s,r)}}function style_styleFunction(t,e,r){var n,i,o;return function(){var s=styleValue(this,t),a=r(this),u=a+"";return null==a&&(this.style.removeProperty(t),u=a=styleValue(this,t)),s===u?null:s===n&&u===i?o:(i=u,o=e(n=s,a))}}function styleMaybeRemove(t,e){var r,n,i,o,s="style."+e,a="end."+s;return function(){var u=schedule_set(this,t),l=u.on,h=null==u.value[s]?o||(o=style_styleRemove(e)):void 0;(l!==r||i!==h)&&(n=(r=l).copy()).on(a,i=h),u.on=n}}function transition_style(t,e,r){var n="transform"==(t+="")?z:transition_interpolate;return null==e?this.styleTween(t,styleNull(t,n)).on("end.style."+t,style_styleRemove(t)):"function"==typeof e?this.styleTween(t,style_styleFunction(t,n,tweenValue(this,"style."+t,e))).each(styleMaybeRemove(this._id,t)):this.styleTween(t,style_styleConstant(t,n,e),r).on("end.style."+t,null)}function styleInterpolate(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function styleTween(t,e,r){var n,i;function tween(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&styleInterpolate(t,o,r)),n}return tween._value=e,tween}function transition_styleTween(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw Error();return this.tween(n,styleTween(t,e,null==r?"":r))}function text_textConstant(t){return function(){this.textContent=t}}function text_textFunction(t){return function(){var e=t(this);this.textContent=null==e?"":e}}function transition_text(t){return this.tween("text","function"==typeof t?text_textFunction(tweenValue(this,"text",t)):text_textConstant(null==t?"":t+""))}function textInterpolate(t){return function(e){this.textContent=t.call(this,e)}}function textTween(t){var e,r;function tween(){var n=t.apply(this,arguments);return n!==r&&(e=(r=n)&&textInterpolate(n)),e}return tween._value=t,tween}function transition_textTween(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw Error();return this.tween(e,textTween(t))}function transition(){for(var t=this._name,e=this._id,r=++Y,n=this._groups,i=n.length,o=0;o<i;++o)for(var s,a=n[o],u=a.length,l=0;l<u;++l)if(s=a[l]){var h=schedule_get(s,e);schedule(s,t,r,l,a,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Transition(n,this._parents,t,r)}function end(){var t,e,r=this,n=r._id,i=r.size();return new Promise(function(o,s){var a={value:s},u={value:function(){0==--i&&o()}};r.each(function(){var r=schedule_set(this,n),i=r.on;i!==t&&((e=(t=i).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(u)),r.on=e}),0===i&&o()})}var Y=0;function Transition(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function transition_transition(t){return m().transition(t)}var G=m.prototype;Transition.prototype=transition_transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,selectChild:G.selectChild,selectChildren:G.selectChildren,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition,call:G.call,nodes:G.nodes,node:G.node,size:G.size,empty:G.empty,each:G.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:tween,delay:delay,duration:duration,ease:ease,easeVarying:transition_easeVarying,end:end,[Symbol.iterator]:G[Symbol.iterator]};var K={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function inherit(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw Error(`transition ${e} not found`);return r}function selection_transition(t){var e,r;t instanceof Transition?(e=t._id,t=t._name):(e=++Y,(r=K).time=now(),t=null==t?null:t+"");for(var n=this._groups,i=n.length,o=0;o<i;++o)for(var s,a=n[o],u=a.length,l=0;l<u;++l)(s=a[l])&&schedule(s,t,e,l,a,r||inherit(s,e));return new Transition(n,this._parents,t,e)}m.prototype.interrupt=selection_interrupt,m.prototype.transition=selection_transition;let{abs:Q,max:Z,min:J}=Math;function type(t){return{type:t}}["w","e"].map(type),["n","s"].map(type),["n","w","e","s","nw","ne","sw","se"].map(type);let tt=Math.sqrt(50),te=Math.sqrt(10),tr=Math.sqrt(2);function tickSpec(t,e,r){let n,i,o;let s=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(s)),u=s/Math.pow(10,a),l=u>=tt?10:u>=te?5:u>=tr?2:1;return(a<0?(n=Math.round(t*(o=Math.pow(10,-a)/l)),i=Math.round(e*o),n/o<t&&++n,i/o>e&&--i,o=-o):(n=Math.round(t/(o=Math.pow(10,a)*l)),i=Math.round(e/o),n*o<t&&++n,i*o>e&&--i),i<n&&.5<=r&&r<2)?tickSpec(t,e,2*r):[n,i,o]}function ticks(t,e,r){if(e=+e,t=+t,!((r=+r)>0))return[];if(t===e)return[t];let n=e<t,[i,o,s]=n?tickSpec(e,t,r):tickSpec(t,e,r);if(!(o>=i))return[];let a=o-i+1,u=Array(a);if(n){if(s<0)for(let t=0;t<a;++t)u[t]=-((o-t)/s);else for(let t=0;t<a;++t)u[t]=(o-t)*s}else if(s<0)for(let t=0;t<a;++t)u[t]=-((i+t)/s);else for(let t=0;t<a;++t)u[t]=(i+t)*s;return u}function tickIncrement(t,e,r){return tickSpec(t=+t,e=+e,r=+r)[2]}function tickStep(t,e,r){e=+e,t=+t,r=+r;let n=e<t,i=n?tickIncrement(e,t,r):tickIncrement(t,e,r);return(n?-1:1)*(i<0?-(1/i):i)}function ascending_ascending(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function descending(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function bisector(t){let e,r,n;function left(t,n,i=0,o=t.length){if(i<o){if(0!==e(n,n))return o;do{let e=i+o>>>1;0>r(t[e],n)?i=e+1:o=e}while(i<o)}return i}function center(t,e,r=0,i=t.length){let o=left(t,e,r,i-1);return o>r&&n(t[o-1],e)>-n(t[o],e)?o-1:o}return 2!==t.length?(e=ascending_ascending,r=(e,r)=>ascending_ascending(t(e),r),n=(e,r)=>t(e)-r):(e=t===ascending_ascending||t===descending?t:bisector_zero,r=t,n=t),{left,center,right:function(t,n,i=0,o=t.length){if(i<o){if(0!==e(n,n))return o;do{let e=i+o>>>1;0>=r(t[e],n)?i=e+1:o=e}while(i<o)}return i}}}function bisector_zero(){return 0}function number_number(t){return null===t?NaN:+t}let tn=bisector(ascending_ascending),ti=tn.right;function genericArray(t,e){var r,n=e?e.length:0,i=t?Math.min(n,t.length):0,o=Array(i),s=Array(n);for(r=0;r<i;++r)o[r]=value(t[r],e[r]);for(;r<n;++r)s[r]=e[r];return function(t){for(r=0;r<i;++r)s[r]=o[r](t);return s}}function date(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function object(t,e){var r,n={},i={};for(r in(null===t||"object"!=typeof t)&&(t={}),(null===e||"object"!=typeof e)&&(e={}),e)r in t?n[r]=value(t[r],e[r]):i[r]=e[r];return function(t){for(r in n)i[r]=n[r](t);return i}}function src_numberArray(t,e){e||(e=[]);var r,n=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(r=0;r<n;++r)i[r]=t[r]*(1-o)+e[r]*o;return i}}function numberArray_isNumberArray(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function value(t,e){var r,n=typeof e;return null==e||"boolean"===n?d3_interpolate_src_constant(e):("number"===n?number:"string"===n?(r=color(e))?(e=r,U):string:e instanceof color?U:e instanceof Date?date:numberArray_isNumberArray(e)?src_numberArray:Array.isArray(e)?genericArray:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?object:number)(t,e)}function round(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function constants(t){return function(){return t}}function src_number_number(t){return+t}tn.left,bisector(number_number).center;var to=[0,1];function continuous_identity(t){return t}function normalize(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:constants(isNaN(e)?NaN:.5)}function clamper(t,e){var r;return t>e&&(r=t,t=e,e=r),function(r){return Math.max(t,Math.min(e,r))}}function bimap(t,e,r){var n=t[0],i=t[1],o=e[0],s=e[1];return i<n?(n=normalize(i,n),o=r(s,o)):(n=normalize(n,i),o=r(o,s)),function(t){return o(n(t))}}function polymap(t,e,r){var n=Math.min(t.length,e.length)-1,i=Array(n),o=Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)i[s]=normalize(t[s],t[s+1]),o[s]=r(e[s],e[s+1]);return function(e){var r=ti(t,e,1,n)-1;return o[r](i[r](e))}}function copy(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function transformer(){var t,e,r,n,i,o,s=to,a=to,u=value,l=continuous_identity;function rescale(){var t=Math.min(s.length,a.length);return l!==continuous_identity&&(l=clamper(s[0],s[t-1])),n=t>2?polymap:bimap,i=o=null,scale}function scale(e){return null==e||isNaN(e=+e)?r:(i||(i=n(s.map(t),a,u)))(t(l(e)))}return scale.invert=function(r){return l(e((o||(o=n(a,s.map(t),number)))(r)))},scale.domain=function(t){return arguments.length?(s=Array.from(t,src_number_number),rescale()):s.slice()},scale.range=function(t){return arguments.length?(a=Array.from(t),rescale()):a.slice()},scale.rangeRound=function(t){return a=Array.from(t),u=round,rescale()},scale.clamp=function(t){return arguments.length?(l=!!t||continuous_identity,rescale()):l!==continuous_identity},scale.interpolate=function(t){return arguments.length?(u=t,rescale()):u},scale.unknown=function(t){return arguments.length?(r=t,scale):r},function(r,n){return t=r,e=n,rescale()}}function continuous(){return transformer()(continuous_identity,continuous_identity)}function initRange(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var ts=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(t){var e;if(!(e=ts.exec(t)))throw Error("invalid format: "+t);return new FormatSpecifier({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function FormatSpecifier(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function formatDecimalParts(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function exponent(t){return(t=formatDecimalParts(Math.abs(t)))?t[1]:NaN}function precisionPrefix(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(exponent(e)/3)))-exponent(Math.abs(t)))}function formatGroup(t,e){return function(r,n){for(var i=r.length,o=[],s=0,a=t[0],u=0;i>0&&a>0&&(u+a+1>n&&(a=Math.max(1,n-u)),o.push(r.substring(i-=a,i+a)),!((u+=a+1)>n));)a=t[s=(s+1)%t.length];return o.reverse().join(e)}}function formatNumerals(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}function formatTrim(t){e:for(var e,r=t.length,n=1,i=-1;n<r;++n)switch(t[n]){case".":i=e=n;break;case"0":0===i&&(i=n),e=n;break;default:if(!+t[n])break e;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}function formatRounded(t,e){var r=formatDecimalParts(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+Array(i-n.length+2).join("0")}formatSpecifier.prototype=FormatSpecifier.prototype,FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var ta={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>formatRounded(100*t,e),r:formatRounded,s:function(t,e){var r=formatDecimalParts(t,e);if(!r)return t+"";var n=r[0],o=r[1],s=o-(i=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,a=n.length;return s===a?n:s>a?n+Array(s-a+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+Array(1-s).join("0")+formatDecimalParts(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function src_identity(t){return t}var tu=Array.prototype.map,tl=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function locale(t){var e=void 0===t.grouping||void 0===t.thousands?src_identity:formatGroup(tu.call(t.grouping,Number),t.thousands+""),r=void 0===t.currency?"":t.currency[0]+"",n=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?src_identity:formatNumerals(tu.call(t.numerals,String)),a=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"−":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function newFormat(t){var h=(t=formatSpecifier(t)).fill,c=t.align,f=t.sign,m=t.symbol,p=t.zero,g=t.width,d=t.comma,y=t.precision,w=t.trim,v=t.type;"n"===v?(d=!0,v="g"):ta[v]||(void 0===y&&(y=12),w=!0,v="g"),(p||"0"===h&&"="===c)&&(p=!0,h="0",c="=");var b="$"===m?r:"#"===m&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===m?n:/[%p]/.test(v)?a:"",M=ta[v],_=/[defgprs%]/.test(v);function format(t){var r,n,a,m=b,S=x;if("c"===v)S=M(t)+S,t="";else{var k=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:M(Math.abs(t),y),w&&(t=formatTrim(t)),k&&0==+t&&"+"!==f&&(k=!1),m=(k?"("===f?f:u:"-"===f||"("===f?"":f)+m,S=("s"===v?tl[8+i/3]:"")+S+(k&&"("===f?")":""),_){for(r=-1,n=t.length;++r<n;)if(48>(a=t.charCodeAt(r))||a>57){S=(46===a?o+t.slice(r+1):t.slice(r))+S,t=t.slice(0,r);break}}}d&&!p&&(t=e(t,1/0));var A=m.length+t.length+S.length,E=A<g?Array(g-A+1).join(h):"";switch(d&&p&&(t=e(E+t,E.length?g-S.length:1/0),E=""),c){case"<":t=m+t+S+E;break;case"=":t=m+E+t+S;break;case"^":t=E.slice(0,A=E.length>>1)+m+t+S+E.slice(A);break;default:t=E+m+t+S}return s(t)}return y=void 0===y?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),format.toString=function(){return t+""},format}function formatPrefix(t,e){var r=newFormat(((t=formatSpecifier(t)).type="f",t)),n=3*Math.max(-8,Math.min(8,Math.floor(exponent(e)/3))),i=Math.pow(10,-n),o=tl[8+n/3];return function(t){return r(i*t)+o}}return{format:newFormat,formatPrefix:formatPrefix}}function precisionRound(t,e){return Math.max(0,exponent(e=Math.abs(e)-(t=Math.abs(t)))-exponent(t))+1}function precisionFixed(t){return Math.max(0,-exponent(Math.abs(t)))}function tickFormat(t,e,r,n){var i,o=tickStep(t,e,r);switch((n=formatSpecifier(null==n?",f":n)).type){case"s":var u=Math.max(Math.abs(t),Math.abs(e));return null!=n.precision||isNaN(i=precisionPrefix(o,u))||(n.precision=i),a(n,u);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(i=precisionRound(o,Math.max(Math.abs(t),Math.abs(e))))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(i=precisionFixed(o))||(n.precision=i-("%"===n.type)*2)}return s(n)}function linearish(t){var e=t.domain;return t.ticks=function(t){var r=e();return ticks(r[0],r[r.length-1],null==t?10:t)},t.tickFormat=function(t,r){var n=e();return tickFormat(n[0],n[n.length-1],null==t?10:t,r)},t.nice=function(r){null==r&&(r=10);var n,i,o=e(),s=0,a=o.length-1,u=o[s],l=o[a],h=10;for(l<u&&(i=u,u=l,l=i,i=s,s=a,a=i);h-- >0;){if((i=tickIncrement(u,l,r))===n)return o[s]=u,o[a]=l,e(o);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else if(i<0)u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i;else break;n=i}return t},t}function linear_linear(){var t=continuous();return t.copy=function(){return copy(t,linear_linear())},initRange.apply(t,arguments),linearish(t)}s=(o=locale({thousands:",",grouping:[3],currency:["$",""]})).format,a=o.formatPrefix;let InternMap=class InternMap extends Map{constructor(t,e=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(let[e,r]of t)this.set(e,r)}get(t){return super.get(intern_get(this,t))}has(t){return super.has(intern_get(this,t))}set(t,e){return super.set(intern_set(this,t),e)}delete(t){return super.delete(intern_delete(this,t))}};function intern_get({_intern:t,_key:e},r){let n=e(r);return t.has(n)?t.get(n):r}function intern_set({_intern:t,_key:e},r){let n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function intern_delete({_intern:t,_key:e},r){let n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function keyof(t){return null!==t&&"object"==typeof t?t.valueOf():t}let th=Symbol("implicit");function ordinal(){var t=new InternMap,e=[],r=[],n=th;function scale(i){let o=t.get(i);if(void 0===o){if(n!==th)return n;t.set(i,o=e.push(i)-1)}return r[o%r.length]}return scale.domain=function(r){if(!arguments.length)return e.slice();for(let n of(e=[],t=new InternMap,r))t.has(n)||t.set(n,e.push(n)-1);return scale},scale.range=function(t){return arguments.length?(r=Array.from(t),scale):r.slice()},scale.unknown=function(t){return arguments.length?(n=t,scale):n},scale.copy=function(){return ordinal(e,r).unknown(n)},initRange.apply(scale,arguments),scale}var tc=function(t){for(var e=t.length/6|0,r=Array(e),n=0;n<e;)r[n]="#"+t.slice(6*n,6*++n);return r}("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function sourceEvent(t){let e;for(;e=t.sourceEvent;)t=e;return t}function src_pointer(t,e){if(t=sourceEvent(t),void 0===e&&(e=t.currentTarget),e){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,[(n=n.matrixTransform(e.getScreenCTM().inverse())).x,n.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}function src_select(t){return"string"==typeof t?new Selection([[document.querySelector(t)]],[document.documentElement]):new Selection([[t]],f)}let tf={capture:!0,passive:!1};function src_noevent(t){t.preventDefault(),t.stopImmediatePropagation()}function nodrag(t){var e=t.document.documentElement,r=src_select(t).on("dragstart.drag",src_noevent,tf);"onselectstart"in e?r.on("selectstart.drag",src_noevent,tf):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function yesdrag(t,e){var r=t.document.documentElement,n=src_select(t).on("dragstart.drag",null);e&&(n.on("click.drag",src_noevent,tf),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}function cosh(t){return((t=Math.exp(t))+1/t)/2}function sinh(t){return((t=Math.exp(t))-1/t)/2}function tanh(t){return((t=Math.exp(2*t))-1)/(t+1)}var tm=function zoomRho(t,e,r){function zoom(n,i){var o,s,a=n[0],u=n[1],l=n[2],h=i[0],c=i[1],f=i[2],m=h-a,p=c-u,g=m*m+p*p;if(g<1e-12)s=Math.log(f/l)/t,o=function(e){return[a+e*m,u+e*p,l*Math.exp(t*e*s)]};else{var d=Math.sqrt(g),y=(f*f-l*l+r*g)/(2*l*e*d),w=(f*f-l*l-r*g)/(2*f*e*d),v=Math.log(Math.sqrt(y*y+1)-y);s=(Math.log(Math.sqrt(w*w+1)-w)-v)/t,o=function(r){var n=r*s,i=cosh(v),o=l/(e*d)*(i*tanh(t*n+v)-sinh(v));return[a+o*m,u+o*p,l*i/cosh(t*n+v)]}}return o.duration=1e3*s*t/Math.SQRT2,o}return zoom.rho=function(t){var e=Math.max(.001,+t),r=e*e,n=r*r;return zoomRho(e,r,n)},zoom}(Math.SQRT2,2,4),d3_zoom_src_constant=t=>()=>t;function ZoomEvent(t,{sourceEvent:e,target:r,transform:n,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:i}})}function Transform(t,e,r){this.k=t,this.x=e,this.y=r}Transform.prototype={constructor:Transform,scale:function(t){return 1===t?this:new Transform(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Transform(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tp=new Transform(1,0,0);function src_noevent_nopropagation(t){t.stopImmediatePropagation()}function d3_zoom_src_noevent(t){t.preventDefault(),t.stopImmediatePropagation()}function zoom_defaultFilter(t){return(!t.ctrlKey||"wheel"===t.type)&&!t.button}function zoom_defaultExtent(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function defaultTransform(){return this.__zoom||tp}function defaultWheelDelta(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function zoom_defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain(t,e,r){var n=t.invertX(e[0][0])-r[0][0],i=t.invertX(e[1][0])-r[1][0],o=t.invertY(e[0][1])-r[0][1],s=t.invertY(e[1][1])-r[1][1];return t.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function zoom(){var t,e,r,n=zoom_defaultFilter,i=zoom_defaultExtent,o=defaultConstrain,s=defaultWheelDelta,a=zoom_defaultTouchable,u=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],h=250,c=tm,f=y("start","zoom","end"),m=0,p=10;function zoom(t){t.property("__zoom",defaultTransform).on("wheel.zoom",wheeled,{passive:!1}).on("mousedown.zoom",mousedowned).on("dblclick.zoom",dblclicked).filter(a).on("touchstart.zoom",touchstarted).on("touchmove.zoom",touchmoved).on("touchend.zoom touchcancel.zoom",touchended).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function scale(t,e){return(e=Math.max(u[0],Math.min(u[1],e)))===t.k?t:new Transform(e,t.x,t.y)}function translate(t,e,r){var n=e[0]-r[0]*t.k,i=e[1]-r[1]*t.k;return n===t.x&&i===t.y?t:new Transform(t.k,n,i)}function centroid(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function schedule(t,e,r,n){t.on("start.zoom",function(){gesture(this,arguments).event(n).start()}).on("interrupt.zoom end.zoom",function(){gesture(this,arguments).event(n).end()}).tween("zoom",function(){var t=arguments,o=gesture(this,t).event(n),s=i.apply(this,t),a=null==r?centroid(s):"function"==typeof r?r.apply(this,t):r,u=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),l=this.__zoom,h="function"==typeof e?e.apply(this,t):e,f=c(l.invert(a).concat(u/l.k),h.invert(a).concat(u/h.k));return function(t){if(1===t)t=h;else{var e=f(t),r=u/e[2];t=new Transform(r,a[0]-e[0]*r,a[1]-e[1]*r)}o.zoom(null,t)}})}function gesture(t,e,r){return!r&&t.__zooming||new Gesture(t,e)}function Gesture(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=i.apply(t,e),this.taps=0}function wheeled(t,...e){if(n.apply(this,arguments)){var r=gesture(this,e).event(t),i=this.__zoom,a=Math.max(u[0],Math.min(u[1],i.k*Math.pow(2,s.apply(this,arguments)))),h=src_pointer(t);if(r.wheel)(r.mouse[0][0]!==h[0]||r.mouse[0][1]!==h[1])&&(r.mouse[1]=i.invert(r.mouse[0]=h)),clearTimeout(r.wheel);else{if(i.k===a)return;r.mouse=[h,i.invert(h)],src_interrupt(this),r.start()}d3_zoom_src_noevent(t),r.wheel=setTimeout(wheelidled,150),r.zoom("mouse",o(translate(scale(i,a),r.mouse[0],r.mouse[1]),r.extent,l))}function wheelidled(){r.wheel=null,r.end()}}function mousedowned(t,...e){if(!r&&n.apply(this,arguments)){var i=t.currentTarget,s=gesture(this,e,!0).event(t),a=src_select(t.view).on("mousemove.zoom",mousemoved,!0).on("mouseup.zoom",mouseupped,!0),u=src_pointer(t,i),h=t.clientX,c=t.clientY;nodrag(t.view),src_noevent_nopropagation(t),s.mouse=[u,this.__zoom.invert(u)],src_interrupt(this),s.start()}function mousemoved(t){if(d3_zoom_src_noevent(t),!s.moved){var e=t.clientX-h,r=t.clientY-c;s.moved=e*e+r*r>m}s.event(t).zoom("mouse",o(translate(s.that.__zoom,s.mouse[0]=src_pointer(t,i),s.mouse[1]),s.extent,l))}function mouseupped(t){a.on("mousemove.zoom mouseup.zoom",null),yesdrag(t.view,s.moved),d3_zoom_src_noevent(t),s.event(t).end()}}function dblclicked(t,...e){if(n.apply(this,arguments)){var r=this.__zoom,s=src_pointer(t.changedTouches?t.changedTouches[0]:t,this),a=r.invert(s),u=r.k*(t.shiftKey?.5:2),c=o(translate(scale(r,u),s,a),i.apply(this,e),l);d3_zoom_src_noevent(t),h>0?src_select(this).transition().duration(h).call(schedule,c,s,t):src_select(this).call(zoom.transform,c,s,t)}}function touchstarted(r,...i){if(n.apply(this,arguments)){var o,s,a,u,l=r.touches,h=l.length,c=gesture(this,i,r.changedTouches.length===h).event(r);for(src_noevent_nopropagation(r),s=0;s<h;++s)u=[u=src_pointer(a=l[s],this),this.__zoom.invert(u),a.identifier],c.touch0?c.touch1||c.touch0[2]===u[2]||(c.touch1=u,c.taps=0):(c.touch0=u,o=!0,c.taps=1+!!t);t&&(t=clearTimeout(t)),o&&(c.taps<2&&(e=u[0],t=setTimeout(function(){t=null},500)),src_interrupt(this),c.start())}}function touchmoved(t,...e){if(this.__zooming){var r,n,i,s,a=gesture(this,e).event(t),u=t.changedTouches,h=u.length;for(d3_zoom_src_noevent(t),r=0;r<h;++r)i=src_pointer(n=u[r],this),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=i:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=i);if(n=a.that.__zoom,a.touch1){var c=a.touch0[0],f=a.touch0[1],m=a.touch1[0],p=a.touch1[1],g=(g=m[0]-c[0])*g+(g=m[1]-c[1])*g,d=(d=p[0]-f[0])*d+(d=p[1]-f[1])*d;n=scale(n,Math.sqrt(g/d)),i=[(c[0]+m[0])/2,(c[1]+m[1])/2],s=[(f[0]+p[0])/2,(f[1]+p[1])/2]}else{if(!a.touch0)return;i=a.touch0[0],s=a.touch0[1]}a.zoom("touch",o(translate(n,i,s),a.extent,l))}}function touchended(t,...n){if(this.__zooming){var i,o,s=gesture(this,n).event(t),a=t.changedTouches,u=a.length;for(src_noevent_nopropagation(t),r&&clearTimeout(r),r=setTimeout(function(){r=null},500),i=0;i<u;++i)o=a[i],s.touch0&&s.touch0[2]===o.identifier?delete s.touch0:s.touch1&&s.touch1[2]===o.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(o=src_pointer(o,this),Math.hypot(e[0]-o[0],e[1]-o[1])<p)){var l=src_select(this).on("dblclick.zoom");l&&l.apply(this,arguments)}}}return zoom.transform=function(t,e,r,n){var i=t.selection?t.selection():t;i.property("__zoom",defaultTransform),t!==i?schedule(t,e,r,n):i.interrupt().each(function(){gesture(this,arguments).event(n).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},zoom.scaleBy=function(t,e,r,n){zoom.scaleTo(t,function(){var t=this.__zoom.k,r="function"==typeof e?e.apply(this,arguments):e;return t*r},r,n)},zoom.scaleTo=function(t,e,r,n){zoom.transform(t,function(){var t=i.apply(this,arguments),n=this.__zoom,s=null==r?centroid(t):"function"==typeof r?r.apply(this,arguments):r,a=n.invert(s),u="function"==typeof e?e.apply(this,arguments):e;return o(translate(scale(n,u),s,a),t,l)},r,n)},zoom.translateBy=function(t,e,r,n){zoom.transform(t,function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof r?r.apply(this,arguments):r),i.apply(this,arguments),l)},null,n)},zoom.translateTo=function(t,e,r,n,s){zoom.transform(t,function(){var t=i.apply(this,arguments),s=this.__zoom,a=null==n?centroid(t):"function"==typeof n?n.apply(this,arguments):n;return o(tp.translate(a[0],a[1]).scale(s.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof r?-r.apply(this,arguments):-r),t,l)},n,s)},Gesture.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=src_select(this.that).datum();f.call(t,this.that,new ZoomEvent(t,{sourceEvent:this.sourceEvent,target:zoom,type:t,transform:this.that.__zoom,dispatch:f}),e)}},zoom.wheelDelta=function(t){return arguments.length?(s="function"==typeof t?t:d3_zoom_src_constant(+t),zoom):s},zoom.filter=function(t){return arguments.length?(n="function"==typeof t?t:d3_zoom_src_constant(!!t),zoom):n},zoom.touchable=function(t){return arguments.length?(a="function"==typeof t?t:d3_zoom_src_constant(!!t),zoom):a},zoom.extent=function(t){return arguments.length?(i="function"==typeof t?t:d3_zoom_src_constant([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),zoom):i},zoom.scaleExtent=function(t){return arguments.length?(u[0]=+t[0],u[1]=+t[1],zoom):[u[0],u[1]]},zoom.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],zoom):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},zoom.constrain=function(t){return arguments.length?(o=t,zoom):o},zoom.duration=function(t){return arguments.length?(h=+t,zoom):h},zoom.interpolate=function(t){return arguments.length?(c=t,zoom):c},zoom.on=function(){var t=f.on.apply(f,arguments);return t===f?zoom:t},zoom.clickDistance=function(t){return arguments.length?(m=(t=+t)*t,zoom):Math.sqrt(m)},zoom.tapDistance=function(t){return arguments.length?(p=+t,zoom):p},zoom}Transform.prototype}}]);